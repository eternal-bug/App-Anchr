# Quality, length and Coverage

[TOC levels=1-3]: # " "
- [Quality, length and Coverage](#quality-length-and-coverage)
- [*Escherichia coli* str. K-12 substr. MG1655](#escherichia-coli-str-k-12-substr-mg1655)
    - [Download](#download)
    - [Preprocess Illumina reads](#preprocess-illumina-reads)
    - [Reads stats](#reads-stats)
    - [Quorum](#quorum)
    - [Down sampling](#down-sampling)
    - [K-unitigs and anchors (sampled)](#k-unitigs-and-anchors-sampled)
    - [Merge anchors with Qxx, Lxx and QxxLxx](#merge-anchors-with-qxx-lxx-and-qxxlxx)
    - [Clear intermediate files](#clear-intermediate-files)
    - [miniasm](#miniasm)
    - [Local corrections](#local-corrections)
    - [kmc](#kmc)


# *Escherichia coli* str. K-12 substr. MG1655

* Genome: INSDC [U00096.3](https://www.ncbi.nlm.nih.gov/nuccore/U00096.3)
* Taxonomy ID: [511145](https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id=511145)
* Proportion of paralogs (> 1000 bp): 0.0323

## Download

* Settings

```bash
BASE_NAME=QLX
REAL_G=4641652
COVERAGE2="40 80"
READ_QUAL="15 20 25 30 35"
READ_LEN="30 60 90"

```

```bash
BASE_NAME=QLX
REAL_G=4641652
COVERAGE2="20 30 40 50 60 80 120 160 200"
READ_QUAL="25 30"
READ_LEN="60"

```

* Reference genome

```bash
mkdir -p ${HOME}/data/anchr/${BASE_NAME}/1_genome
cd ${HOME}/data/anchr/${BASE_NAME}/1_genome

cp ~/data/anchr/e_coli/1_genome/genome.fa .
cp ~/data/anchr/e_coli/1_genome/paralogs.fas .

```

* Illumina

```bash
mkdir -p ${HOME}/data/anchr/${BASE_NAME}/2_illumina
cd ${HOME}/data/anchr/${BASE_NAME}/2_illumina

ln -sf ${HOME}/data/anchr/e_coli/2_illumina/MiSeq_Ecoli_MG1655_110721_PF_R1.fastq.gz R1.fq.gz
ln -sf ${HOME}/data/anchr/e_coli/2_illumina/MiSeq_Ecoli_MG1655_110721_PF_R2.fastq.gz R2.fq.gz

cat <<EOF > illumina_adapters.fa
>multiplexing-forward
GATCGGAAGAGCACACGTCT
>solexa-forward
AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT
>truseq-forward-contam
AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC
>truseq-reverse-contam
AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTA
>nextera-forward-read-contam
CTGTCTCTTATACACATCTCCGAGCCCACGAGAC
>nextera-reverse-read-contam
CTGTCTCTTATACACATCTGACGCTGCCGACGA
>solexa-reverse
AGATCGGAAGAGCGGTTCAGCAGGAATGCCGAG

EOF

```

## Preprocess Illumina reads

## Reads stats

| Name     |     N50 |        Sum |        # |
|:---------|--------:|-----------:|---------:|
| Genome   | 4641652 |    4641652 |        1 |
| Paralogs |    1934 |     195673 |      106 |
| Illumina |     151 | 1730299940 | 11458940 |
| uniq     |     151 | 1727289000 | 11439000 |
| shuffle  |     151 | 1727289000 | 11439000 |
| scythe   |     151 | 1722450607 | 11439000 |
| Q15L30   |     151 | 1605703103 | 11288436 |
| Q15L60   |     151 | 1575519248 | 10949858 |
| Q15L90   |     151 | 1510984308 | 10345828 |
| Q20L30   |     151 | 1514584050 | 11126596 |
| Q20L60   |     151 | 1468709458 | 10572422 |
| Q20L90   |     151 | 1370119196 |  9617554 |
| Q25L30   |     151 | 1382782641 | 10841386 |
| Q25L60   |     151 | 1317617346 |  9994728 |
| Q25L90   |     151 | 1177142378 |  8586574 |
| Q30L30   |     125 | 1192536117 | 10716954 |
| Q30L60   |     127 | 1149107745 |  9783292 |
| Q30L90   |     130 | 1021609911 |  8105773 |
| Q35L30   |      64 |  588252718 |  9588363 |
| Q35L60   |      72 |  366922898 |  5062192 |
| Q35L90   |      95 |   35259773 |   364046 |

## Quorum

| Name   |   SumIn | CovIn |  SumOut | CovOut | Discard% | AvgRead | Kmer | RealG |  EstG | Est/Real |   RunTime |
|:-------|--------:|------:|--------:|-------:|---------:|--------:|-----:|------:|------:|---------:|----------:|
| Q15L30 |   1.61G | 345.9 |   1.25G |  268.8 |  22.284% |     142 | "75" | 4.64M | 5.52M |     1.19 | 0:04'57'' |
| Q15L60 |   1.58G | 339.4 |   1.23G |  264.1 |  22.186% |     143 | "75" | 4.64M | 5.47M |     1.18 | 0:04'24'' |
| Q15L90 |   1.51G | 325.5 |   1.18G |  254.0 |  21.975% |     146 | "75" | 4.64M | 5.35M |     1.15 | 0:04'08'' |
| Q20L30 |   1.51G | 326.3 |   1.32G |  284.1 |  12.941% |     136 | "65" | 4.64M | 4.85M |     1.04 | 0:04'06'' |
| Q20L60 |   1.47G | 316.4 |   1.28G |  275.6 |  12.888% |     139 | "65" | 4.64M | 4.82M |     1.04 | 0:04'02'' |
| Q20L90 |   1.37G | 295.2 |   1.19G |  256.8 |  13.001% |     143 | "95" | 4.64M | 4.69M |     1.01 | 0:03'54'' |
| Q25L30 |   1.38G | 297.9 |    1.3G |  280.6 |   5.808% |     129 | "57" | 4.64M | 4.59M |     0.99 | 0:03'54'' |
| Q25L60 |   1.32G | 283.9 |   1.24G |  267.4 |   5.801% |     133 | "83" | 4.64M | 4.58M |     0.99 | 0:03'50'' |
| Q25L90 |   1.18G | 253.6 |   1.11G |  238.8 |   5.832% |     137 | "89" | 4.64M | 4.57M |     0.99 | 0:03'12'' |
| Q30L30 |   1.19G | 257.0 |   1.16G |  250.7 |   2.437% |     115 | "65" | 4.64M | 4.56M |     0.98 | 0:03'25'' |
| Q30L60 |   1.15G | 247.7 |   1.12G |  241.6 |   2.484% |     120 | "71" | 4.64M | 4.56M |     0.98 | 0:03'16'' |
| Q30L90 |   1.02G | 220.4 | 996.45M |  214.7 |   2.605% |     128 | "79" | 4.64M | 4.56M |     0.98 | 0:02'54'' |
| Q35L30 | 589.03M | 126.9 | 582.15M |  125.4 |   1.169% |      62 | "37" | 4.64M | 4.56M |     0.98 | 0:01'51'' |
| Q35L60 | 369.07M |  79.5 | 362.78M |   78.2 |   1.705% |      73 | "45" | 4.64M | 4.51M |     0.97 | 0:01'29'' |
| Q35L90 |  35.58M |   7.7 |  32.82M |    7.1 |   7.770% |      98 | "65" | 4.64M | 2.03M |     0.44 | 0:00'32'' |

## Down sampling

## K-unitigs and anchors (sampled)

| Name          |  SumCor | CovCor | N50Anchor |   Sum |    # | N50Others |     Sum |    # |                Kmer | RunTimeKU | RunTimeAN |
|:--------------|--------:|-------:|----------:|------:|-----:|----------:|--------:|-----:|--------------------:|----------:|:----------|
| Q15L30X40P000 | 185.67M |   40.0 |      1915 | 3.29M | 1769 |       762 |   1.09M | 1491 | "31,41,51,61,71,81" | 0:01'42'' | 0:00'51'' |
| Q15L30X40P001 | 185.67M |   40.0 |      2040 | 3.31M | 1713 |       762 |   1.06M | 1461 | "31,41,51,61,71,81" | 0:01'38'' | 0:00'51'' |
| Q15L30X40P002 | 185.67M |   40.0 |      1982 | 3.31M | 1746 |       752 |   1.08M | 1487 | "31,41,51,61,71,81" | 0:01'42'' | 0:00'53'' |
| Q15L30X40P003 | 185.67M |   40.0 |      2088 | 3.33M | 1716 |       757 |   1.07M | 1460 | "31,41,51,61,71,81" | 0:01'48'' | 0:00'47'' |
| Q15L30X40P004 | 185.67M |   40.0 |      2059 | 3.29M | 1695 |       754 |   1.08M | 1481 | "31,41,51,61,71,81" | 0:01'41'' | 0:00'48'' |
| Q15L30X40P005 | 185.67M |   40.0 |      2008 | 3.28M | 1716 |       769 |    1.1M | 1501 | "31,41,51,61,71,81" | 0:01'45'' | 0:00'52'' |
| Q15L30X80P000 | 371.33M |   80.0 |      1400 |  1.4M |  973 |       709 |   1.87M | 2684 | "31,41,51,61,71,81" | 0:03'03'' | 0:00'49'' |
| Q15L30X80P001 | 371.33M |   80.0 |      1423 | 1.42M |  971 |       700 |   1.89M | 2744 | "31,41,51,61,71,81" | 0:03'02'' | 0:00'51'' |
| Q15L30X80P002 | 371.33M |   80.0 |      1406 | 1.35M |  935 |       705 |    1.9M | 2742 | "31,41,51,61,71,81" | 0:03'05'' | 0:00'51'' |
| Q15L60X40P000 | 185.67M |   40.0 |      1928 | 3.27M | 1754 |       765 |   1.12M | 1523 | "31,41,51,61,71,81" | 0:01'50'' | 0:00'51'' |
| Q15L60X40P001 | 185.67M |   40.0 |      2040 |  3.3M | 1713 |       757 |   1.07M | 1478 | "31,41,51,61,71,81" | 0:01'51'' | 0:00'57'' |
| Q15L60X40P002 | 185.67M |   40.0 |      1988 |  3.3M | 1726 |       755 |    1.1M | 1507 | "31,41,51,61,71,81" | 0:01'49'' | 0:00'52'' |
| Q15L60X40P003 | 185.67M |   40.0 |      2083 | 3.34M | 1724 |       761 |   1.06M | 1452 | "31,41,51,61,71,81" | 0:01'49'' | 0:00'50'' |
| Q15L60X40P004 | 185.67M |   40.0 |      2039 | 3.27M | 1694 |       757 |    1.1M | 1503 | "31,41,51,61,71,81" | 0:01'46'' | 0:00'54'' |
| Q15L60X40P005 | 185.67M |   40.0 |      2039 | 3.27M | 1688 |       768 |   1.11M | 1514 | "31,41,51,61,71,81" | 0:01'49'' | 0:00'56'' |
| Q15L60X80P000 | 371.33M |   80.0 |      1401 | 1.38M |  956 |       706 |   1.89M | 2720 | "31,41,51,61,71,81" | 0:03'03'' | 0:00'47'' |
| Q15L60X80P001 | 371.33M |   80.0 |      1426 |  1.4M |  956 |       701 |   1.92M | 2782 | "31,41,51,61,71,81" | 0:03'11'' | 0:00'51'' |
| Q15L60X80P002 | 371.33M |   80.0 |      1399 | 1.34M |  923 |       707 |   1.91M | 2760 | "31,41,51,61,71,81" | 0:03'10'' | 0:00'50'' |
| Q15L90X40P000 | 185.67M |   40.0 |      1904 | 3.26M | 1749 |       762 |   1.15M | 1561 | "31,41,51,61,71,81" | 0:01'51'' | 0:00'53'' |
| Q15L90X40P001 | 185.67M |   40.0 |      2040 | 3.27M | 1686 |       771 |   1.12M | 1523 | "31,41,51,61,71,81" | 0:01'49'' | 0:00'51'' |
| Q15L90X40P002 | 185.67M |   40.0 |      1999 | 3.32M | 1739 |       757 |    1.1M | 1504 | "31,41,51,61,71,81" | 0:01'56'' | 0:00'50'' |
| Q15L90X40P003 | 185.67M |   40.0 |      2021 | 3.31M | 1743 |       758 |   1.09M | 1498 | "31,41,51,61,71,81" | 0:01'48'' | 0:00'53'' |
| Q15L90X40P004 | 185.67M |   40.0 |      1978 | 3.29M | 1726 |       757 |    1.1M | 1510 | "31,41,51,61,71,81" | 0:01'47'' | 0:00'52'' |
| Q15L90X40P005 | 185.67M |   40.0 |      2045 | 3.26M | 1693 |       761 |   1.14M | 1552 | "31,41,51,61,71,81" | 0:01'49'' | 0:00'52'' |
| Q15L90X80P000 | 371.33M |   80.0 |      1409 | 1.38M |  952 |       708 |   1.92M | 2757 | "31,41,51,61,71,81" | 0:03'02'' | 0:00'54'' |
| Q15L90X80P001 | 371.33M |   80.0 |      1416 | 1.41M |  961 |       704 |    1.9M | 2755 | "31,41,51,61,71,81" | 0:03'09'' | 0:00'54'' |
| Q15L90X80P002 | 371.33M |   80.0 |      1397 | 1.33M |  928 |       707 |   1.96M | 2826 | "31,41,51,61,71,81" | 0:03'06'' | 0:00'51'' |
| Q20L30X40P000 | 185.67M |   40.0 |      5545 | 4.45M | 1090 |       750 | 167.04K |  230 | "31,41,51,61,71,81" | 0:01'47'' | 0:00'55'' |
| Q20L30X40P001 | 185.67M |   40.0 |      5320 | 4.46M | 1094 |       805 | 167.03K |  221 | "31,41,51,61,71,81" | 0:01'45'' | 0:00'59'' |
| Q20L30X40P002 | 185.67M |   40.0 |      5809 | 4.45M | 1034 |       793 | 175.29K |  236 | "31,41,51,61,71,81" | 0:01'44'' | 0:00'57'' |
| Q20L30X40P003 | 185.67M |   40.0 |      5539 | 4.45M | 1069 |       795 | 163.91K |  216 | "31,41,51,61,71,81" | 0:01'45'' | 0:01'05'' |
| Q20L30X40P004 | 185.67M |   40.0 |      5378 | 4.44M | 1096 |       757 | 171.23K |  235 | "31,41,51,61,71,81" | 0:01'49'' | 0:00'59'' |
| Q20L30X40P005 | 185.67M |   40.0 |      5565 | 4.45M | 1101 |       786 | 170.55K |  229 | "31,41,51,61,71,81" | 0:01'45'' | 0:01'01'' |
| Q20L30X40P006 | 185.67M |   40.0 |      5403 | 4.44M | 1088 |       798 | 174.05K |  230 | "31,41,51,61,71,81" | 0:01'45'' | 0:00'59'' |
| Q20L30X80P000 | 371.33M |   80.0 |      2456 | 3.82M | 1722 |       775 | 701.18K |  946 | "31,41,51,61,71,81" | 0:02'48'' | 0:00'59'' |
| Q20L30X80P001 | 371.33M |   80.0 |      2485 | 3.84M | 1702 |       778 |  709.2K |  960 | "31,41,51,61,71,81" | 0:02'49'' | 0:01'03'' |
| Q20L30X80P002 | 371.33M |   80.0 |      2480 | 3.82M | 1729 |       757 | 701.66K |  958 | "31,41,51,61,71,81" | 0:02'45'' | 0:01'01'' |
| Q20L60X40P000 | 185.67M |   40.0 |      5396 | 4.44M | 1114 |       749 |  179.3K |  247 | "31,41,51,61,71,81" | 0:01'37'' | 0:00'54'' |
| Q20L60X40P001 | 185.67M |   40.0 |      5133 | 4.45M | 1120 |       811 | 178.13K |  234 | "31,41,51,61,71,81" | 0:01'44'' | 0:00'55'' |
| Q20L60X40P002 | 185.67M |   40.0 |      5509 | 4.44M | 1072 |       799 | 187.36K |  251 | "31,41,51,61,71,81" | 0:01'40'' | 0:00'57'' |
| Q20L60X40P003 | 185.67M |   40.0 |      5676 | 4.44M | 1066 |       787 | 172.43K |  228 | "31,41,51,61,71,81" | 0:01'40'' | 0:01'00'' |
| Q20L60X40P004 | 185.67M |   40.0 |      4925 | 4.43M | 1141 |       756 | 186.92K |  258 | "31,41,51,61,71,81" | 0:01'43'' | 0:01'05'' |
| Q20L60X40P005 | 185.67M |   40.0 |      5544 | 4.45M | 1100 |       800 | 173.62K |  230 | "31,41,51,61,71,81" | 0:01'40'' | 0:00'59'' |
| Q20L60X80P000 | 371.33M |   80.0 |      2450 | 3.82M | 1734 |       775 | 702.83K |  946 | "31,41,51,61,71,81" | 0:02'43'' | 0:01'02'' |
| Q20L60X80P001 | 371.33M |   80.0 |      2501 | 3.83M | 1707 |       769 | 711.54K |  967 | "31,41,51,61,71,81" | 0:02'46'' | 0:01'06'' |
| Q20L60X80P002 | 371.33M |   80.0 |      2499 | 3.82M | 1731 |       758 | 708.13K |  967 | "31,41,51,61,71,81" | 0:02'44'' | 0:01'05'' |
| Q20L90X40P000 | 185.67M |   40.0 |      6964 | 4.51M |  896 |       809 | 108.54K |  145 | "31,41,51,61,71,81" | 0:01'52'' | 0:00'55'' |
| Q20L90X40P001 | 185.67M |   40.0 |      6999 | 4.51M |  902 |       813 | 108.44K |  142 | "31,41,51,61,71,81" | 0:01'52'' | 0:01'00'' |
| Q20L90X40P002 | 185.67M |   40.0 |      7036 |  4.5M |  886 |       767 | 116.02K |  159 | "31,41,51,61,71,81" | 0:01'52'' | 0:00'59'' |
| Q20L90X40P003 | 185.67M |   40.0 |      7256 | 4.49M |  868 |       822 | 126.32K |  165 | "31,41,51,61,71,81" | 0:01'54'' | 0:01'01'' |
| Q20L90X40P004 | 185.67M |   40.0 |      7269 |  4.5M |  879 |       777 | 113.03K |  152 | "31,41,51,61,71,81" | 0:01'50'' | 0:01'00'' |
| Q20L90X40P005 | 185.67M |   40.0 |      6774 | 4.51M |  916 |       817 | 109.87K |  142 | "31,41,51,61,71,81" | 0:01'55'' | 0:01'01'' |
| Q20L90X80P000 | 371.33M |   80.0 |      3189 | 4.22M | 1540 |       800 | 387.52K |  514 | "31,41,51,61,71,81" | 0:02'59'' | 0:01'04'' |
| Q20L90X80P001 | 371.33M |   80.0 |      3412 | 4.19M | 1482 |       777 | 413.37K |  556 | "31,41,51,61,71,81" | 0:02'58'' | 0:01'05'' |
| Q20L90X80P002 | 371.33M |   80.0 |      3342 | 4.22M | 1519 |       798 | 378.62K |  499 | "31,41,51,61,71,81" | 0:02'55'' | 0:01'06'' |
| Q25L30X40P000 | 185.67M |   40.0 |     37874 | 4.54M |  188 |       848 |  30.79K |   32 | "31,41,51,61,71,81" | 0:01'50'' | 0:01'17'' |
| Q25L30X40P001 | 185.67M |   40.0 |     36675 | 4.54M |  200 |       812 |  19.43K |   26 | "31,41,51,61,71,81" | 0:01'45'' | 0:01'16'' |
| Q25L30X40P002 | 185.67M |   40.0 |     42533 | 4.54M |  187 |       754 |   18.3K |   25 | "31,41,51,61,71,81" | 0:01'46'' | 0:01'15'' |
| Q25L30X40P003 | 185.67M |   40.0 |     43854 | 4.54M |  189 |       812 |  20.07K |   27 | "31,41,51,61,71,81" | 0:01'46'' | 0:01'18'' |
| Q25L30X40P004 | 185.67M |   40.0 |     41950 | 4.54M |  188 |       705 |  19.83K |   28 | "31,41,51,61,71,81" | 0:01'53'' | 0:01'19'' |
| Q25L30X40P005 | 185.67M |   40.0 |     37673 | 4.54M |  192 |       819 |  17.76K |   23 | "31,41,51,61,71,81" | 0:01'38'' | 0:01'18'' |
| Q25L30X40P006 | 185.67M |   40.0 |     40109 | 4.54M |  203 |       783 |  23.03K |   30 | "31,41,51,61,71,81" | 0:01'52'' | 0:01'19'' |
| Q25L30X80P000 | 371.33M |   80.0 |     25886 | 4.54M |  282 |       812 |  22.44K |   30 | "31,41,51,61,71,81" | 0:02'50'' | 0:01'20'' |
| Q25L30X80P001 | 371.33M |   80.0 |     29470 | 4.54M |  257 |       767 |  17.16K |   23 | "31,41,51,61,71,81" | 0:02'52'' | 0:01'17'' |
| Q25L30X80P002 | 371.33M |   80.0 |     27623 | 4.54M |  271 |       852 |  23.19K |   31 | "31,41,51,61,71,81" | 0:02'51'' | 0:01'18'' |
| Q25L60X40P000 | 185.67M |   40.0 |     37874 | 4.54M |  196 |       754 |  24.73K |   33 | "31,41,51,61,71,81" | 0:01'44'' | 0:01'18'' |
| Q25L60X40P001 | 185.67M |   40.0 |     35671 | 4.54M |  210 |       754 |  18.75K |   26 | "31,41,51,61,71,81" | 0:01'44'' | 0:01'18'' |
| Q25L60X40P002 | 185.67M |   40.0 |     39567 | 4.55M |  197 |       754 |  20.44K |   28 | "31,41,51,61,71,81" | 0:01'47'' | 0:01'16'' |
| Q25L60X40P003 | 185.67M |   40.0 |     41467 | 4.53M |  189 |       696 |  18.29K |   26 | "31,41,51,61,71,81" | 0:01'44'' | 0:01'15'' |
| Q25L60X40P004 | 185.67M |   40.0 |     38634 | 4.54M |  191 |       706 |  18.33K |   25 | "31,41,51,61,71,81" | 0:01'43'' | 0:01'17'' |
| Q25L60X40P005 | 185.67M |   40.0 |     39149 | 4.53M |  191 |       811 |  20.36K |   27 | "31,41,51,61,71,81" | 0:01'45'' | 0:01'14'' |
| Q25L60X80P000 | 371.33M |   80.0 |     25691 | 4.54M |  288 |       737 |  21.43K |   29 | "31,41,51,61,71,81" | 0:02'46'' | 0:01'31'' |
| Q25L60X80P001 | 371.33M |   80.0 |     29971 | 4.54M |  251 |       767 |  18.35K |   25 | "31,41,51,61,71,81" | 0:02'45'' | 0:01'10'' |
| Q25L60X80P002 | 371.33M |   80.0 |     28681 | 4.54M |  264 |       841 |  21.67K |   28 | "31,41,51,61,71,81" | 0:02'51'' | 0:01'19'' |
| Q25L90X40P000 | 185.67M |   40.0 |     32611 | 4.54M |  236 |       794 |  27.54K |   36 | "31,41,51,61,71,81" | 0:01'50'' | 0:01'14'' |
| Q25L90X40P001 | 185.67M |   40.0 |     33623 | 4.54M |  230 |       754 |  18.89K |   26 | "31,41,51,61,71,81" | 0:01'49'' | 0:01'12'' |
| Q25L90X40P002 | 185.67M |   40.0 |     36372 | 4.54M |  223 |       805 |  23.26K |   32 | "31,41,51,61,71,81" | 0:01'52'' | 0:01'16'' |
| Q25L90X40P003 | 185.67M |   40.0 |     35233 | 4.53M |  217 |       778 |  23.06K |   32 | "31,41,51,61,71,81" | 0:01'47'' | 0:01'13'' |
| Q25L90X40P004 | 185.67M |   40.0 |     33644 | 4.53M |  223 |       840 |  22.48K |   29 | "31,41,51,61,71,81" | 0:01'47'' | 0:01'15'' |
| Q25L90X80P000 | 371.33M |   80.0 |     25691 | 4.54M |  282 |       718 |  25.83K |   36 | "31,41,51,61,71,81" | 0:03'03'' | 0:01'15'' |
| Q25L90X80P001 | 371.33M |   80.0 |     30480 | 4.54M |  261 |       795 |  21.84K |   30 | "31,41,51,61,71,81" | 0:02'44'' | 0:01'21'' |
| Q30L30X40P000 | 185.67M |   40.0 |     44646 | 4.54M |  181 |       830 |  35.04K |   44 | "31,41,51,61,71,81" | 0:01'43'' | 0:01'22'' |
| Q30L30X40P001 | 185.67M |   40.0 |     47317 | 4.54M |  173 |       872 |  33.38K |   40 | "31,41,51,61,71,81" | 0:01'41'' | 0:01'25'' |
| Q30L30X40P002 | 185.67M |   40.0 |     44647 | 4.54M |  181 |       777 |  32.16K |   43 | "31,41,51,61,71,81" | 0:01'37'' | 0:01'21'' |
| Q30L30X40P003 | 185.67M |   40.0 |     41915 | 4.54M |  186 |       820 |  28.04K |   36 | "31,41,51,61,71,81" | 0:01'44'' | 0:01'20'' |
| Q30L30X40P004 | 185.67M |   40.0 |     42691 | 4.54M |  183 |       811 |  33.21K |   43 | "31,41,51,61,71,81" | 0:01'37'' | 0:01'22'' |
| Q30L30X40P005 | 185.67M |   40.0 |     41944 | 4.55M |  180 |       873 |  33.29K |   36 | "31,41,51,61,71,81" | 0:01'37'' | 0:01'23'' |
| Q30L30X80P000 | 371.33M |   80.0 |     50795 | 4.54M |  152 |       840 |  20.87K |   27 | "31,41,51,61,71,81" | 0:02'39'' | 0:01'40'' |
| Q30L30X80P001 | 371.33M |   80.0 |     54868 | 4.53M |  153 |       848 |  23.19K |   29 | "31,41,51,61,71,81" | 0:02'28'' | 0:01'42'' |
| Q30L30X80P002 | 371.33M |   80.0 |     49172 | 4.53M |  155 |       829 |  22.84K |   28 | "31,41,51,61,71,81" | 0:02'50'' | 0:01'41'' |
| Q30L60X40P000 | 185.67M |   40.0 |     41181 | 4.54M |  196 |       812 |  34.09K |   44 | "31,41,51,61,71,81" | 0:01'41'' | 0:01'23'' |
| Q30L60X40P001 | 185.67M |   40.0 |     41921 | 4.53M |  190 |       843 |  32.68K |   42 | "31,41,51,61,71,81" | 0:01'42'' | 0:01'20'' |
| Q30L60X40P002 | 185.67M |   40.0 |     40062 | 4.54M |  203 |       980 |  58.59K |   46 | "31,41,51,61,71,81" | 0:01'35'' | 0:01'16'' |
| Q30L60X40P003 | 185.67M |   40.0 |     40180 | 4.54M |  200 |       754 |  23.09K |   30 | "31,41,51,61,71,81" | 0:01'43'' | 0:01'14'' |
| Q30L60X40P004 | 185.67M |   40.0 |     36233 | 4.54M |  204 |       734 |  27.47K |   37 | "31,41,51,61,71,81" | 0:01'36'' | 0:01'22'' |
| Q30L60X40P005 | 185.67M |   40.0 |     33478 | 4.55M |  223 |       801 |   39.2K |   52 | "31,41,51,61,71,81" | 0:01'40'' | 0:01'18'' |
| Q30L60X80P000 | 371.33M |   80.0 |     48459 | 4.53M |  162 |       825 |   24.1K |   31 | "31,41,51,61,71,81" | 0:02'45'' | 0:01'32'' |
| Q30L60X80P001 | 371.33M |   80.0 |     46295 | 4.53M |  170 |       824 |  22.45K |   29 | "31,41,51,61,71,81" | 0:02'40'' | 0:01'51'' |
| Q30L60X80P002 | 371.33M |   80.0 |     42299 | 4.54M |  177 |       905 |  28.21K |   27 | "31,41,51,61,71,81" | 0:02'46'' | 0:01'29'' |
| Q30L90X40P000 | 185.67M |   40.0 |     26803 | 4.54M |  292 |       877 |  33.18K |   42 | "31,41,51,61,71,81" | 0:01'42'' | 0:01'15'' |
| Q30L90X40P001 | 185.67M |   40.0 |     26204 | 4.54M |  292 |       886 |  30.54K |   37 | "31,41,51,61,71,81" | 0:01'43'' | 0:01'09'' |
| Q30L90X40P002 | 185.67M |   40.0 |     23723 | 4.54M |  303 |       899 |  31.35K |   40 | "31,41,51,61,71,81" | 0:01'42'' | 0:01'03'' |
| Q30L90X40P003 | 185.67M |   40.0 |     25783 | 4.52M |  295 |       842 |  35.26K |   44 | "31,41,51,61,71,81" | 0:01'44'' | 0:01'07'' |
| Q30L90X40P004 | 185.67M |   40.0 |     29397 | 4.54M |  256 |       797 |  34.49K |   46 | "31,41,51,61,71,81" | 0:01'40'' | 0:01'08'' |
| Q30L90X80P000 | 371.33M |   80.0 |     40062 | 4.55M |  212 |       826 |  22.75K |   29 | "31,41,51,61,71,81" | 0:02'47'' | 0:01'43'' |
| Q30L90X80P001 | 371.33M |   80.0 |     34345 | 4.53M |  219 |       840 |  25.48K |   32 | "31,41,51,61,71,81" | 0:02'43'' | 0:01'24'' |
| Q35L30X40P000 | 185.67M |   40.0 |      6633 | 4.39M |  928 |       743 | 265.37K |  369 | "31,41,51,61,71,81" | 0:00'53'' | 0:01'00'' |
| Q35L30X40P001 | 185.67M |   40.0 |      6399 | 4.37M |  944 |       749 | 275.22K |  379 | "31,41,51,61,71,81" | 0:00'50'' | 0:01'04'' |
| Q35L30X40P002 | 185.67M |   40.0 |      6738 |  4.4M |  947 |       753 | 268.54K |  369 | "31,41,51,61,71,81" | 0:00'51'' | 0:01'11'' |
| Q35L30X80P000 | 371.33M |   80.0 |     11342 | 4.52M |  610 |       743 | 187.76K |  262 | "31,41,51,61,71,81" | 0:01'17'' | 0:01'43'' |
| Q35L60X40P000 | 185.67M |   40.0 |      2580 | 2.88M | 1232 |       836 |   1.15M | 1258 | "31,41,51,61,71,81" | 0:00'55'' | 0:00'51'' |

| Name           |  SumCor | CovCor | N50Anchor |   Sum |    # | N50Others |     Sum |   # |                Kmer | RunTimeKU | RunTimeAN |
|:---------------|--------:|-------:|----------:|------:|-----:|----------:|--------:|----:|--------------------:|----------:|:----------|
| Q25L60X20P000  |  92.83M |   20.0 |     30982 | 4.55M |  235 |       868 |  49.52K |  62 | "31,41,51,61,71,81" | 0:01'32'' | 0:01'08'' |
| Q25L60X20P001  |  92.83M |   20.0 |     35631 | 4.54M |  238 |       759 |  37.33K |  50 | "31,41,51,61,71,81" | 0:01'19'' | 0:01'07'' |
| Q25L60X20P002  |  92.83M |   20.0 |     31862 | 4.54M |  239 |       812 |  42.69K |  54 | "31,41,51,61,71,81" | 0:01'10'' | 0:01'08'' |
| Q25L60X20P003  |  92.83M |   20.0 |     33695 | 4.54M |  234 |       755 |  36.67K |  49 | "31,41,51,61,71,81" | 0:01'11'' | 0:01'10'' |
| Q25L60X20P004  |  92.83M |   20.0 |     34341 | 4.54M |  245 |       766 |  42.19K |  56 | "31,41,51,61,71,81" | 0:01'07'' | 0:01'09'' |
| Q25L60X20P005  |  92.83M |   20.0 |     29126 | 4.55M |  248 |       849 |  44.17K |  56 | "31,41,51,61,71,81" | 0:01'11'' | 0:01'07'' |
| Q25L60X20P006  |  92.83M |   20.0 |     35571 | 4.54M |  241 |       837 |  34.48K |  43 | "31,41,51,61,71,81" | 0:01'11'' | 0:01'08'' |
| Q25L60X20P007  |  92.83M |   20.0 |     35233 | 4.53M |  223 |       718 |  40.42K |  55 | "31,41,51,61,71,81" | 0:01'14'' | 0:01'06'' |
| Q25L60X20P008  |  92.83M |   20.0 |     35482 | 4.55M |  229 |       812 |  34.86K |  45 | "31,41,51,61,71,81" | 0:01'05'' | 0:01'06'' |
| Q25L60X20P009  |  92.83M |   20.0 |     36979 | 4.53M |  221 |       781 |  38.15K |  51 | "31,41,51,61,71,81" | 0:01'12'' | 0:01'06'' |
| Q25L60X20P010  |  92.83M |   20.0 |     35804 | 4.54M |  227 |       845 |  31.76K |  39 | "31,41,51,61,71,81" | 0:01'10'' | 0:01'08'' |
| Q25L60X20P011  |  92.83M |   20.0 |     33889 | 4.54M |  233 |       752 |  33.36K |  45 | "31,41,51,61,71,81" | 0:01'11'' | 0:01'05'' |
| Q25L60X20P012  |  92.83M |   20.0 |     32161 | 4.54M |  238 |       774 |  35.85K |  48 | "31,41,51,61,71,81" | 0:01'13'' | 0:01'06'' |
| Q25L60X30P000  | 139.25M |   30.0 |     35672 | 4.54M |  201 |       849 |  28.12K |  36 | "31,41,51,61,71,81" | 0:01'23'' | 0:01'10'' |
| Q25L60X30P001  | 139.25M |   30.0 |     40059 | 4.54M |  191 |       823 |  26.72K |  35 | "31,41,51,61,71,81" | 0:01'30'' | 0:01'13'' |
| Q25L60X30P002  | 139.25M |   30.0 |     38807 | 4.54M |  199 |       778 |  27.09K |  36 | "31,41,51,61,71,81" | 0:01'34'' | 0:01'12'' |
| Q25L60X30P003  | 139.25M |   30.0 |     40210 | 4.54M |  194 |       812 |  26.33K |  35 | "31,41,51,61,71,81" | 0:01'27'' | 0:01'16'' |
| Q25L60X30P004  | 139.25M |   30.0 |     47274 | 4.54M |  193 |       767 |  23.47K |  32 | "31,41,51,61,71,81" | 0:01'25'' | 0:01'15'' |
| Q25L60X30P005  | 139.25M |   30.0 |     41758 | 4.54M |  182 |       762 |  20.03K |  28 | "31,41,51,61,71,81" | 0:01'30'' | 0:01'16'' |
| Q25L60X30P006  | 139.25M |   30.0 |     40210 | 4.54M |  192 |       813 |  24.77K |  31 | "31,41,51,61,71,81" | 0:01'29'' | 0:01'16'' |
| Q25L60X30P007  | 139.25M |   30.0 |     41758 | 4.54M |  185 |       821 |  23.17K |  30 | "31,41,51,61,71,81" | 0:01'31'' | 0:01'19'' |
| Q25L60X40P000  | 185.67M |   40.0 |     37874 | 4.54M |  196 |       754 |  24.73K |  33 | "31,41,51,61,71,81" | 0:01'44'' | 0:01'18'' |
| Q25L60X40P001  | 185.67M |   40.0 |     35671 | 4.54M |  210 |       754 |  18.75K |  26 | "31,41,51,61,71,81" | 0:01'44'' | 0:01'18'' |
| Q25L60X40P002  | 185.67M |   40.0 |     39567 | 4.55M |  197 |       754 |  20.44K |  28 | "31,41,51,61,71,81" | 0:01'47'' | 0:01'16'' |
| Q25L60X40P003  | 185.67M |   40.0 |     41467 | 4.53M |  189 |       696 |  18.29K |  26 | "31,41,51,61,71,81" | 0:01'44'' | 0:01'15'' |
| Q25L60X40P004  | 185.67M |   40.0 |     38634 | 4.54M |  191 |       706 |  18.33K |  25 | "31,41,51,61,71,81" | 0:01'43'' | 0:01'17'' |
| Q25L60X40P005  | 185.67M |   40.0 |     39149 | 4.53M |  191 |       811 |  20.36K |  27 | "31,41,51,61,71,81" | 0:01'45'' | 0:01'14'' |
| Q25L60X50P000  | 232.08M |   50.0 |     31644 | 4.54M |  223 |       812 |  20.66K |  27 | "31,41,51,61,71,81" | 0:02'06'' | 0:01'18'' |
| Q25L60X50P001  | 232.08M |   50.0 |     34964 | 4.54M |  204 |       705 |  18.05K |  26 | "31,41,51,61,71,81" | 0:01'59'' | 0:01'20'' |
| Q25L60X50P002  | 232.08M |   50.0 |     40119 | 4.54M |  198 |       812 |  18.79K |  25 | "31,41,51,61,71,81" | 0:02'02'' | 0:01'17'' |
| Q25L60X50P003  | 232.08M |   50.0 |     36793 | 4.54M |  197 |       705 |  18.22K |  26 | "31,41,51,61,71,81" | 0:02'00'' | 0:01'21'' |
| Q25L60X50P004  | 232.08M |   50.0 |     37180 | 4.53M |  208 |       811 |  21.44K |  29 | "31,41,51,61,71,81" | 0:02'06'' | 0:01'17'' |
| Q25L60X60P000  |  278.5M |   60.0 |     30992 | 4.54M |  241 |       754 |  21.22K |  29 | "31,41,51,61,71,81" | 0:02'14'' | 0:01'23'' |
| Q25L60X60P001  |  278.5M |   60.0 |     35677 | 4.54M |  223 |       754 |  18.47K |  26 | "31,41,51,61,71,81" | 0:02'18'' | 0:01'21'' |
| Q25L60X60P002  |  278.5M |   60.0 |     33910 | 4.54M |  225 |       705 |  18.37K |  25 | "31,41,51,61,71,81" | 0:02'18'' | 0:01'22'' |
| Q25L60X60P003  |  278.5M |   60.0 |     31301 | 4.54M |  229 |      1166 |  33.81K |  28 | "31,41,51,61,71,81" | 0:02'16'' | 0:01'24'' |
| Q25L60X80P000  | 371.33M |   80.0 |     25691 | 4.54M |  288 |       737 |  21.43K |  29 | "31,41,51,61,71,81" | 0:02'46'' | 0:01'31'' |
| Q25L60X80P001  | 371.33M |   80.0 |     29971 | 4.54M |  251 |       767 |  18.35K |  25 | "31,41,51,61,71,81" | 0:02'45'' | 0:01'10'' |
| Q25L60X80P002  | 371.33M |   80.0 |     28681 | 4.54M |  264 |       841 |  21.67K |  28 | "31,41,51,61,71,81" | 0:02'51'' | 0:01'19'' |
| Q25L60X120P000 |    557M |  120.0 |     20277 | 4.54M |  362 |       847 |  27.58K |  35 | "31,41,51,61,71,81" | 0:03'40'' | 0:01'38'' |
| Q25L60X120P001 |    557M |  120.0 |     22229 | 4.54M |  342 |       697 |  25.33K |  34 | "31,41,51,61,71,81" | 0:04'03'' | 0:01'36'' |
| Q25L60X160P000 | 742.66M |  160.0 |     16017 | 4.54M |  410 |       847 |  31.21K |  38 | "31,41,51,61,71,81" | 0:05'11'' | 0:01'43'' |
| Q25L60X200P000 | 928.33M |  200.0 |     14614 | 4.54M |  447 |       853 |  34.42K |  41 | "31,41,51,61,71,81" | 0:05'30'' | 0:01'41'' |
| Q30L60X20P000  |  92.83M |   20.0 |     23868 | 4.54M |  336 |       877 |   71.4K |  84 | "31,41,51,61,71,81" | 0:01'24'' | 0:01'04'' |
| Q30L60X20P001  |  92.83M |   20.0 |     23955 | 4.54M |  337 |       812 |   74.9K |  94 | "31,41,51,61,71,81" | 0:01'17'' | 0:01'02'' |
| Q30L60X20P002  |  92.83M |   20.0 |     23007 | 4.53M |  335 |       855 |  77.43K |  98 | "31,41,51,61,71,81" | 0:01'12'' | 0:00'59'' |
| Q30L60X20P003  |  92.83M |   20.0 |     21631 | 4.54M |  345 |       845 |  67.22K |  87 | "31,41,51,61,71,81" | 0:01'15'' | 0:01'02'' |
| Q30L60X20P004  |  92.83M |   20.0 |     22620 | 4.53M |  339 |       808 |  73.55K |  97 | "31,41,51,61,71,81" | 0:01'11'' | 0:01'04'' |
| Q30L60X20P005  |  92.83M |   20.0 |     23550 | 4.53M |  325 |       772 |  63.22K |  84 | "31,41,51,61,71,81" | 0:01'13'' | 0:01'00'' |
| Q30L60X20P006  |  92.83M |   20.0 |     21721 | 4.54M |  350 |       837 |  77.26K |  89 | "31,41,51,61,71,81" | 0:01'09'' | 0:01'03'' |
| Q30L60X20P007  |  92.83M |   20.0 |     21309 | 4.54M |  351 |       795 |  72.95K |  94 | "31,41,51,61,71,81" | 0:01'14'' | 0:01'06'' |
| Q30L60X20P008  |  92.83M |   20.0 |     21456 | 4.54M |  350 |       834 |  72.01K |  91 | "31,41,51,61,71,81" | 0:01'11'' | 0:01'00'' |
| Q30L60X20P009  |  92.83M |   20.0 |     21806 | 4.54M |  332 |       758 |   59.8K |  80 | "31,41,51,61,71,81" | 0:01'14'' | 0:01'03'' |
| Q30L60X20P010  |  92.83M |   20.0 |     24178 | 4.54M |  337 |       794 |  73.35K |  93 | "31,41,51,61,71,81" | 0:01'13'' | 0:01'05'' |
| Q30L60X20P011  |  92.83M |   20.0 |      4807 | 4.32M | 1167 |       767 | 321.24K | 433 | "31,41,51,61,71,81" | 0:01'01'' | 0:00'55'' |
| Q30L60X30P000  | 139.25M |   30.0 |     32976 | 4.55M |  227 |       823 |   42.9K |  55 | "31,41,51,61,71,81" | 0:01'27'' | 0:01'09'' |
| Q30L60X30P001  | 139.25M |   30.0 |     34340 | 4.54M |  227 |       829 |  45.75K |  60 | "31,41,51,61,71,81" | 0:01'33'' | 0:01'07'' |
| Q30L60X30P002  | 139.25M |   30.0 |     33289 | 4.54M |  231 |       854 |   39.8K |  51 | "31,41,51,61,71,81" | 0:01'26'' | 0:01'16'' |
| Q30L60X30P003  | 139.25M |   30.0 |     32601 | 4.55M |  245 |       719 |  42.63K |  59 | "31,41,51,61,71,81" | 0:01'31'' | 0:01'12'' |
| Q30L60X30P004  | 139.25M |   30.0 |     33550 | 4.54M |  231 |       754 |  31.67K |  41 | "31,41,51,61,71,81" | 0:01'25'' | 0:01'12'' |
| Q30L60X30P005  | 139.25M |   30.0 |     31612 | 4.54M |  237 |       890 |  46.64K |  49 | "31,41,51,61,71,81" | 0:01'30'' | 0:01'17'' |
| Q30L60X30P006  | 139.25M |   30.0 |     34345 | 4.54M |  226 |       770 |  34.37K |  45 | "31,41,51,61,71,81" | 0:01'23'' | 0:01'13'' |
| Q30L60X30P007  | 139.25M |   30.0 |     25781 | 4.54M |  299 |       790 |  72.68K |  97 | "31,41,51,61,71,81" | 0:01'21'' | 0:01'16'' |
| Q30L60X40P000  | 185.67M |   40.0 |     41181 | 4.54M |  196 |       812 |  34.09K |  44 | "31,41,51,61,71,81" | 0:01'41'' | 0:01'23'' |
| Q30L60X40P001  | 185.67M |   40.0 |     41921 | 4.53M |  190 |       843 |  32.68K |  42 | "31,41,51,61,71,81" | 0:01'42'' | 0:01'20'' |
| Q30L60X40P002  | 185.67M |   40.0 |     40062 | 4.54M |  203 |       980 |  58.59K |  46 | "31,41,51,61,71,81" | 0:01'35'' | 0:01'16'' |
| Q30L60X40P003  | 185.67M |   40.0 |     40180 | 4.54M |  200 |       754 |  23.09K |  30 | "31,41,51,61,71,81" | 0:01'43'' | 0:01'14'' |
| Q30L60X40P004  | 185.67M |   40.0 |     36233 | 4.54M |  204 |       734 |  27.47K |  37 | "31,41,51,61,71,81" | 0:01'36'' | 0:01'22'' |
| Q30L60X40P005  | 185.67M |   40.0 |     33478 | 4.55M |  223 |       801 |   39.2K |  52 | "31,41,51,61,71,81" | 0:01'40'' | 0:01'18'' |
| Q30L60X50P000  | 232.08M |   50.0 |     48132 | 4.54M |  178 |       975 |  47.88K |  39 | "31,41,51,61,71,81" | 0:02'00'' | 0:01'20'' |
| Q30L60X50P001  | 232.08M |   50.0 |     43854 | 4.53M |  181 |       812 |  25.83K |  34 | "31,41,51,61,71,81" | 0:01'52'' | 0:01'20'' |
| Q30L60X50P002  | 232.08M |   50.0 |     41462 | 4.54M |  184 |       812 |  22.64K |  30 | "31,41,51,61,71,81" | 0:01'54'' | 0:01'25'' |
| Q30L60X50P003  | 232.08M |   50.0 |     41181 | 4.54M |  187 |       820 |  27.27K |  34 | "31,41,51,61,71,81" | 0:01'56'' | 0:01'24'' |
| Q30L60X60P000  |  278.5M |   60.0 |     48282 | 4.54M |  170 |       976 |  43.51K |  34 | "31,41,51,61,71,81" | 0:02'10'' | 0:01'33'' |
| Q30L60X60P001  |  278.5M |   60.0 |     48131 | 4.54M |  175 |       777 |  30.32K |  40 | "31,41,51,61,71,81" | 0:02'10'' | 0:01'31'' |
| Q30L60X60P002  |  278.5M |   60.0 |     42691 | 4.54M |  178 |       728 |   21.2K |  28 | "31,41,51,61,71,81" | 0:02'09'' | 0:01'29'' |
| Q30L60X60P003  |  278.5M |   60.0 |     41944 | 4.54M |  185 |       894 |  30.25K |  31 | "31,41,51,61,71,81" | 0:02'10'' | 0:01'29'' |
| Q30L60X80P000  | 371.33M |   80.0 |     48459 | 4.53M |  162 |       825 |   24.1K |  31 | "31,41,51,61,71,81" | 0:02'45'' | 0:01'32'' |
| Q30L60X80P001  | 371.33M |   80.0 |     46295 | 4.53M |  170 |       824 |  22.45K |  29 | "31,41,51,61,71,81" | 0:02'40'' | 0:01'51'' |
| Q30L60X80P002  | 371.33M |   80.0 |     42299 | 4.54M |  177 |       905 |  28.21K |  27 | "31,41,51,61,71,81" | 0:02'46'' | 0:01'29'' |
| Q30L60X120P000 |    557M |  120.0 |     52798 | 4.53M |  159 |       767 |  23.13K |  29 | "31,41,51,61,71,81" | 0:03'30'' | 0:02'07'' |
| Q30L60X120P001 |    557M |  120.0 |     46294 | 4.54M |  165 |       818 |  18.77K |  22 | "31,41,51,61,71,81" | 0:03'41'' | 0:01'56'' |
| Q30L60X160P000 | 742.66M |  160.0 |     52798 | 4.53M |  156 |       850 |  22.83K |  26 | "31,41,51,61,71,81" | 0:04'41'' | 0:02'32'' |
| Q30L60X200P000 | 928.33M |  200.0 |     53735 | 4.53M |  154 |       946 |  19.66K |  21 | "31,41,51,61,71,81" | 0:05'11'' | 0:02'47'' |

## Merge anchors with Qxx, Lxx and QxxLxx

```bash
cd ${HOME}/data/anchr/${BASE_NAME}

# merge anchors with Qxx
for Q in ${READ_QUAL}; do
    mkdir -p mergeQ${Q}
    anchr contained \
        $(
            parallel -k --no-run-if-empty -j 6 '
                if [ -e Q{1}L{2}X{3}P{4}/anchor/anchor.fasta ]; then
                    echo Q{1}L{2}X{3}P{4}/anchor/anchor.fasta
                fi
                ' ::: ${Q} :::  ${READ_LEN} ::: ${COVERAGE2} ::: $(printf "%03d " {0..100})
        ) \
        --len 1000 --idt 0.98 --proportion 0.99999 --parallel 16 \
        -o stdout \
        | faops filter -a 1000 -l 0 stdin mergeQ${Q}/anchor.contained.fasta
    anchr orient mergeQ${Q}/anchor.contained.fasta --len 1000 --idt 0.98 -o mergeQ${Q}/anchor.orient.fasta
    anchr merge mergeQ${Q}/anchor.orient.fasta --len 1000 --idt 0.999 -o mergeQ${Q}/anchor.merge0.fasta
    anchr contained mergeQ${Q}/anchor.merge0.fasta --len 1000 --idt 0.98 \
        --proportion 0.99 --parallel 16 -o stdout \
        | faops filter -a 1000 -l 0 stdin mergeQ${Q}/anchor.merge.fasta
done

# quast
rm -fr 9_qa_mergeQxx
quast --no-check --threads 16 \
    -R 1_genome/genome.fa \
    $( parallel -k 'printf "mergeQ{1}/anchor.merge.fasta "' ::: ${READ_QUAL} ) \
    1_genome/paralogs.fas \
    --label "$( parallel -k 'printf "mergeQ{1},"' ::: ${READ_QUAL} )paralogs" \
    -o 9_qa_mergeQxx

# merge anchors with Lxx
for L in ${READ_LEN}; do
    mkdir -p mergeL${L}
    anchr contained \
        $(
            parallel -k --no-run-if-empty -j 6 '
                if [ -e Q{1}L{2}X{3}P{4}/anchor/anchor.fasta ]; then
                    echo Q{1}L{2}X{3}P{4}/anchor/anchor.fasta
                fi
                ' ::: ${READ_QUAL} ::: ${L} ::: ${COVERAGE2} ::: $(printf "%03d " {0..100})
        ) \
        --len 1000 --idt 0.98 --proportion 0.99999 --parallel 16 \
        -o stdout \
        | faops filter -a 1000 -l 0 stdin mergeL${L}/anchor.contained.fasta
    anchr orient mergeL${L}/anchor.contained.fasta --len 1000 --idt 0.98 -o mergeL${L}/anchor.orient.fasta
    anchr merge mergeL${L}/anchor.orient.fasta --len 1000 --idt 0.999 -o mergeL${L}/anchor.merge0.fasta
    anchr contained mergeL${L}/anchor.merge0.fasta --len 1000 --idt 0.98 \
        --proportion 0.99 --parallel 16 -o stdout \
        | faops filter -a 1000 -l 0 stdin mergeL${L}/anchor.merge.fasta
done

# quast
rm -fr 9_qa_mergeLxx
quast --no-check --threads 16 \
    -R 1_genome/genome.fa \
    $( parallel -k 'printf "mergeL{1}/anchor.merge.fasta "' ::: ${READ_LEN} ) \
    1_genome/paralogs.fas \
    --label "$( parallel -k 'printf "mergeL{1},"' ::: ${READ_LEN} )paralogs" \
    -o 9_qa_mergeLxx

# merge anchors with QxxLxx
for Q in ${READ_QUAL}; do
    for L in ${READ_LEN}; do
        mkdir -p mergeQ${Q}L${L}
        anchr contained \
            $(
                parallel -k --no-run-if-empty -j 6 '
                    if [ -e Q{1}L{2}X{3}P{4}/anchor/anchor.fasta ]; then
                        echo Q{1}L{2}X{3}P{4}/anchor/anchor.fasta
                    fi
                    ' ::: ${Q} ::: ${L} ::: ${COVERAGE2} ::: $(printf "%03d " {0..100})
            ) \
            --len 1000 --idt 0.98 --proportion 0.99999 --parallel 16 \
            -o stdout \
            | faops filter -a 1000 -l 0 stdin mergeQ${Q}L${L}/anchor.contained.fasta
        anchr orient mergeQ${Q}L${L}/anchor.contained.fasta --len 1000 --idt 0.98 -o mergeQ${Q}L${L}/anchor.orient.fasta
        anchr merge mergeQ${Q}L${L}/anchor.orient.fasta --len 1000 --idt 0.999 -o mergeQ${Q}L${L}/anchor.merge0.fasta
        anchr contained mergeQ${Q}L${L}/anchor.merge0.fasta --len 1000 --idt 0.98 \
            --proportion 0.99 --parallel 16 -o stdout \
            | faops filter -a 1000 -l 0 stdin mergeQ${Q}L${L}/anchor.merge.fasta
    done
done

# quast
rm -fr 9_qa_mergeQxxLxx
quast --no-check --threads 16 \
    -R 1_genome/genome.fa \
    $( parallel -k 'printf "mergeQ{1}L{2}/anchor.merge.fasta "' ::: ${READ_QUAL} ::: ${READ_LEN} ) \
    1_genome/paralogs.fas \
    --label "$( parallel -k 'printf "mergeQ{1}L{2},"' ::: ${READ_QUAL} ::: ${READ_LEN} )paralogs" \
    -o 9_qa_mergeQxxLxx

# merge anchors with QxxXxx
for Q in ${READ_QUAL}; do
    for X in ${COVERAGE2}; do
        mkdir -p mergeQ${Q}X${X}
        anchr contained \
            $(
                parallel -k --no-run-if-empty -j 6 '
                    if [ -e Q{1}L{2}X{3}P{4}/anchor/anchor.fasta ]; then
                        echo Q{1}L{2}X{3}P{4}/anchor/anchor.fasta
                    fi
                    ' ::: ${Q} ::: 60 ::: ${X} ::: $(printf "%03d " {0..100})
            ) \
            --len 1000 --idt 0.98 --proportion 0.99999 --parallel 16 \
            -o stdout \
            | faops filter -a 1000 -l 0 stdin mergeQ${Q}X${X}/anchor.contained.fasta
        anchr orient mergeQ${Q}X${X}/anchor.contained.fasta --len 1000 --idt 0.98 -o mergeQ${Q}X${X}/anchor.orient.fasta
        anchr merge mergeQ${Q}X${X}/anchor.orient.fasta --len 1000 --idt 0.999 -o mergeQ${Q}X${X}/anchor.merge0.fasta
        anchr contained mergeQ${Q}X${X}/anchor.merge0.fasta --len 1000 --idt 0.98 \
            --proportion 0.99 --parallel 16 -o stdout \
            | faops filter -a 1000 -l 0 stdin mergeQ${Q}X${X}/anchor.merge.fasta
    done
done

# quast
rm -fr 9_qa_mergeQxxXxx
quast --no-check --threads 16 \
    -R 1_genome/genome.fa \
    $( parallel -k 'printf "mergeQ{1}X{2}/anchor.merge.fasta "' ::: ${READ_QUAL} ::: ${COVERAGE2} ) \
    1_genome/paralogs.fas \
    --label "$( parallel -k 'printf "mergeQ{1}X{2},"' ::: ${READ_QUAL} ::: ${COVERAGE2} )paralogs" \
    -o 9_qa_mergeQxxXxx

```

## Clear intermediate files

## miniasm

* `-S skip self and dual mappings`
* `-w INT minizer window size [{-k}*2/3]`
* `-L INT min matching length [40]`
* `-m FLOAT merge two chains if FLOAT fraction of minimizers are shared [0.50]`
* `-t INT number of threads [3]`

```bash
BASE_NAME=e_coli
cd ${HOME}/data/anchr/${BASE_NAME}

mkdir -p miniasm

minimap -Sw5 -L100 -m0 -t16 \
    3_pacbio/pacbio.40x.fasta 3_pacbio/pacbio.40x.fasta \
    > miniasm/pacbio.40x.paf

miniasm miniasm/pacbio.40x.paf > miniasm/utg.noseq.gfa

miniasm -f 3_pacbio/pacbio.40x.fasta miniasm/pacbio.40x.paf \
    > miniasm/utg.gfa

awk '/^S/{print ">"$2"\n"$3}' miniasm/utg.gfa > miniasm/utg.fa

minimap 1_genome/genome.fa miniasm/utg.fa | minidot - > miniasm/utg.eps
```

```bash
#real    0m19.504s
#user    1m11.237s
#sys     0m18.500s
time anchr paf2ovlp --parallel 16 miniasm/pacbio.40x.paf -o miniasm/pacbio.40x.ovlp.tsv

#real    0m19.451s
#user    0m43.343s
#sys     0m9.734s
time anchr paf2ovlp --parallel 4 miniasm/pacbio.40x.paf -o miniasm/pacbio.40x.ovlp.tsv

#real    0m17.324s
#user    0m9.276s
#sys     1m23.833s
time jrange covered miniasm/pacbio.40x.paf --longest --paf -o miniasm/pacbio.40x.pos.txt
```

## Local corrections

```bash
BASE_NAME=e_coli
REAL_G=4641652
cd ${HOME}/data/anchr/${BASE_NAME}

rm -fr localCor
anchr overlap2 \
    --parallel 16 \
    merge/anchor.merge.fasta \
    3_pacbio/pacbio.40x.trim.fasta \
    -d localCor \
    -b 10 --len 1000 --idt 0.85 --all

pushd localCor

anchr cover \
    --range "1-$(faops n50 -H -N 0 -C anchor.fasta)" \
    --len 1000 --idt 0.85 -c 2 \
    anchorLong.ovlp.tsv \
    -o anchor.cover.json
cat anchor.cover.json | jq "." > environment.json

rm -fr group
anchr localcor \
    anchorLong.db \
    anchorLong.ovlp.tsv \
    --parallel 16 \
    --range $(cat environment.json | jq -r '.TRUSTED') \
    --len 1000 --idt 0.85 --trim -v

faops some -i -l 0 \
    long.fasta \
    group/overlapped.long.txt \
    independentLong.fasta

# localCor
gzip -d -c -f $(find group -type f -name "*.correctedReads.fasta.gz") \
    | faops filter -l 0 stdin stdout \
    | grep -E '^>long' -A 1 \
    | sed '/^--$/d' \
    | faops dazz -a -l 0 stdin stdout \
    | pigz -c > localCor.fasta.gz

canu \
    -p ${BASE_NAME} -d localCor \
    gnuplotTested=true \
    genomeSize=${REAL_G} \
    -pacbio-corrected localCor.fasta.gz \
    -pacbio-corrected anchor.fasta

canu \
    -p ${BASE_NAME} -d localCorIndep \
    gnuplotTested=true \
    genomeSize=${REAL_G} \
    -pacbio-raw localCor.fasta.gz \
    -pacbio-raw anchor.fasta \
    -pacbio-raw independentLong.fasta

# localTrim
gzip -d -c -f $(find group -type f -name "*.trimmedReads.fasta.gz") \
    | faops filter -l 0 stdin stdout \
    | grep -E '^>long' -A 1 \
    | sed '/^--$/d' \
    | faops dazz -a -l 0 stdin stdout \
    | pigz -c > localTrim.fasta.gz

canu \
    -p ${BASE_NAME} -d localTrim \
    gnuplotTested=true \
    genomeSize=${REAL_G} \
    -pacbio-corrected localCor.fasta.gz \
    -pacbio-corrected anchor.fasta

# globalTrim
canu -assemble \
    -p ${BASE_NAME} -d globalTrim \
    gnuplotTested=true \
    genomeSize=${REAL_G} \
    -pacbio-corrected ../canu-raw-40x/${BASE_NAME}.trimmedReads.fasta.gz \
    -pacbio-corrected anchor.fasta

popd

# quast
rm -fr 9_qa_localCor
quast --no-check --threads 16 \
    --eukaryote \
    -R 1_genome/genome.fa \
    localCor/anchor.fasta \
    localCor/localCor/${BASE_NAME}.contigs.fasta \
    localCor/localCorIndep/${BASE_NAME}.contigs.fasta \
    localCor/localTrim/${BASE_NAME}.contigs.fasta \
    localCor/globalTrim/${BASE_NAME}.contigs.fasta \
    canu-raw-40x/${BASE_NAME}.contigs.fasta \
    canu-trim-40x/${BASE_NAME}.contigs.fasta \
    1_genome/paralogs.fas \
    --label "anchor,localCor,localCorIndep,localTrim,globalTrim,40x,40x.trim,paralogs" \
    -o 9_qa_localCor

find . -type d -name "correction" | xargs rm -fr

```

## kmc

```bash
BASE_NAME=e_coli
cd ${HOME}/data/anchr/${BASE_NAME}

mkdir -p 2_illumina/kmc
cd 2_illumina/kmc

# raw
cat <<EOF > list.tmp
../R1.fq.gz
../R2.fq.gz

EOF

kmc -k51 -n100 -ci3 @list.tmp raw . 
kmc_tools transform raw histogram hist.raw.txt

# uniq
cat <<EOF > list.tmp
../R1.uniq.fq.gz
../R2.uniq.fq.gz

EOF

kmc -k51 -n100 -ci3 @list.tmp uniq . 
kmc_tools transform uniq histogram hist.uniq.txt

# Q25L60
cat <<EOF > list.tmp
../Q25L60/R1.fq.gz
../Q25L60/R2.fq.gz

EOF

kmc -k51 -n100 -ci1 @list.tmp Q25L60 . 
kmc_tools transform Q25L60 histogram hist.Q25L60.txt

#kmc_tools transform Q25L60 dump dump.Q25L60.txt

kmc_tools filter Q25L60 @list.tmp -ci3 filtered.fa -fa

faops n50 -H -S -C \
    ../Q25L60/R1.fq.gz \
    ../Q25L60/R2.fq.gz;
    
faops n50 -H -S -C \
    ../Q25L60/pe.cor.fa;

faops n50 -H -S -C \
    filtered.fa;

```

## CalcUniqueness

```bash
cd ${HOME}/data/anchr/${BASE_NAME}

bbcountunique.sh \
    in=2_illumina/Q25L60/pe.cor.fa \
    out=2_illumina/Q25L60/histogram.txt

bbcountunique.sh \
    in=2_illumina/Q30L60/pe.cor.fa \
    out=2_illumina/Q30L60/histogram.txt

```
