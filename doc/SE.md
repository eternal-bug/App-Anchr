# Single End and Single End R2

[TOC levels=1-3]: # " "
- [Single End and Single End R2](#single-end-and-single-end-r2)
- [SE](#se)
    - [SE: download](#se-download)
    - [SE: run](#se-run)
- [SE2](#se2)
    - [SE2: download](#se2-download)
    - [SE2: run](#se2-run)
- [Results](#results)
    - [Reads](#reads)
    - [Anchors](#anchors)
    - [Comparison](#comparison)


# SE

*Escherichia coli* str. K-12 substr. MG1655

* Genome: INSDC [U00096.3](https://www.ncbi.nlm.nih.gov/nuccore/U00096.3)
* Taxonomy ID: [511145](https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id=511145)
* Proportion of paralogs (> 1000 bp): 0.0323

## SE: download

* Settings

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=SE

```

* Reference genome

```bash
mkdir -p ${WORKING_DIR}/${BASE_NAME}/1_genome
cd ${WORKING_DIR}/${BASE_NAME}/1_genome

cp ../../e_coli/1_genome/genome.fa .
cp ../../e_coli/1_genome/paralogs.fas .

```

* Illumina

```bash
mkdir -p ${WORKING_DIR}/${BASE_NAME}/2_illumina
cd ${WORKING_DIR}/${BASE_NAME}/2_illumina

cp ../../e_coli/2_illumina/MiSeq_Ecoli_MG1655_110721_PF_R1.fastq.gz R1.fq.gz

```

## SE: run

```bash
rsync -avP ~/data/anchr/SE/ wangq@202.119.37.251:data/anchr/SE

# rsync -avP wangq@202.119.37.251:data/anchr/SE/ ~/data/anchr/SE

```

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=SE

cd ${WORKING_DIR}/${BASE_NAME}

anchr template \
    . \
    --se \
    --basename ${BASE_NAME} \
    --genome 4641652 \
    --trim2 "--uniq --shuffle --bbduk" \
    --cov2 "40 80 all" \
    --qual2 "25 30" \
    --len2 "60" \
    --filter "adapter,phix,artifact" \
    --tadpole \
    --parallel 24

# run
bsub -q largemem -n 24 -J "${BASE_NAME}-0_master" "bash 0_master.sh"

bsub -w "ended(${BASE_NAME}-0_master)" \
    -q largemem -n 24 -J "${BASE_NAME}-0_cleanup" "bash 0_cleanup.sh"

```

# SE2

## SE2: download

* Settings

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=SE2

```

* Reference genome

```bash
mkdir -p ${WORKING_DIR}/${BASE_NAME}/1_genome
cd ${WORKING_DIR}/${BASE_NAME}/1_genome

cp ../../e_coli/1_genome/genome.fa .
cp ../../e_coli/1_genome/paralogs.fas .

```

* Illumina

```bash
mkdir -p ${WORKING_DIR}/${BASE_NAME}/2_illumina
cd ${WORKING_DIR}/${BASE_NAME}/2_illumina

cp ../../e_coli/2_illumina/MiSeq_Ecoli_MG1655_110721_PF_R2.fastq.gz R1.fq.gz

```

## SE2: run

```bash
rsync -avP ~/data/anchr/SE2/ wangq@202.119.37.251:data/anchr/SE2

# rsync -avP wangq@202.119.37.251:data/anchr/SE2/ ~/data/anchr/SE2

```

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=SE2

cd ${WORKING_DIR}/${BASE_NAME}

anchr template \
    . \
    --se \
    --basename ${BASE_NAME} \
    --genome 4641652 \
    --trim2 "--uniq --shuffle --bbduk" \
    --cov2 "40 80 all" \
    --qual2 "25 30" \
    --len2 "60" \
    --filter "adapter,phix,artifact" \
    --tadpole \
    --parallel 24

# run
bsub -q largemem -n 24 -J "${BASE_NAME}-0_master" "bash 0_master.sh"

bsub -w "ended(${BASE_NAME}-0_master)" \
    -q largemem -n 24 -J "${BASE_NAME}-0_cleanup" "bash 0_cleanup.sh"

```

# Results

## Reads

| Name     |     N50 |     Sum |       # |
|:---------|--------:|--------:|--------:|
| Genome   | 4641652 | 4641652 |       1 |
| Paralogs |    1934 |  195673 |     106 |
| Illumina |     151 | 865.15M | 5729470 |
| uniq     |     151 | 717.62M | 4752465 |
| shuffle  |     151 | 717.62M | 4752465 |
| bbduk    |     150 | 712.42M | 4752355 |
| Q25L60   |     150 | 601.43M | 4434431 |
| Q30L60   |     140 | 519.88M | 4122879 |

| Name     |     N50 |     Sum |       # |
|:---------|--------:|--------:|--------:|
| Genome   | 4641652 | 4641652 |       1 |
| Paralogs |    1934 |  195673 |     106 |
| Illumina |     151 | 865.15M | 5729470 |
| uniq     |     151 | 778.63M | 5156497 |
| shuffle  |     151 | 778.63M | 5156497 |
| bbduk    |     150 | 773.12M | 5156490 |
| Q25L60   |     134 | 573.23M | 4618608 |
| Q30L60   |     118 | 464.19M | 4198967 |

| Name   | CovIn | CovOut | Discard% | AvgRead | Kmer | RealG |  EstG | Est/Real |   RunTime |
|:-------|------:|-------:|---------:|--------:|-----:|------:|------:|---------:|----------:|
| Q25L60 | 130.5 |  123.1 |    5.73% |     136 | "31" | 4.64M | 4.57M |     0.98 | 0:01'15'' |
| Q30L60 | 112.9 |  109.7 |    2.81% |     128 | "31" | 4.64M | 4.56M |     0.98 | 0:01'06'' |

| Name   | CovIn | CovOut | Discard% | AvgRead | Kmer | RealG |  EstG | Est/Real |   RunTime |
|:-------|------:|-------:|---------:|--------:|-----:|------:|------:|---------:|----------:|
| Q25L60 | 124.5 |  117.2 |    5.90% |     125 | "31" | 4.64M | 4.56M |     0.98 | 0:01'12'' |
| Q30L60 | 100.9 |   98.6 |    2.27% |     112 | "31" | 4.64M | 4.56M |     0.98 | 0:01'02'' |

## Anchors

* Kunitigs

| Name           | CovCor | Mapped% | N50Anchor |   Sum |   # | N50Others |    Sum |    # | median | MAD | lower | upper |                Kmer | RunTimeKU | RunTimeAN |
|:---------------|-------:|--------:|----------:|------:|----:|----------:|-------:|-----:|-------:|----:|------:|------:|--------------------:|----------:|----------:|
| Q25L60X40P000  |   40.0 |  98.71% |     40744 | 4.52M | 181 |        49 | 37.91K |  882 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'53'' | 0:01'01'' |
| Q25L60X40P001  |   40.0 |  98.67% |     44581 | 4.52M | 184 |        49 | 33.66K |  782 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'53'' | 0:00'59'' |
| Q25L60X40P002  |   40.0 |  98.72% |     40827 | 4.52M | 185 |        48 | 34.35K |  801 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'53'' | 0:01'00'' |
| Q25L60X80P000  |   80.0 |  98.53% |     33844 | 4.52M | 226 |        38 | 27.02K |  775 |   78.0 | 2.0 |  20.0 | 126.0 | "31,41,51,61,71,81" | 0:01'24'' | 0:00'58'' |
| Q25L60XallP000 |  123.1 |  98.47% |     32099 | 4.53M | 250 |        28 | 20.76K |  775 |  121.0 | 3.0 |  20.0 | 195.0 | "31,41,51,61,71,81" | 0:01'58'' | 0:01'00'' |
| Q30L60X40P000  |   40.0 |  98.86% |     44128 | 4.51M | 180 |        65 | 56.38K |  994 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'52'' | 0:01'03'' |
| Q30L60X40P001  |   40.0 |  98.90% |     48376 | 4.51M | 180 |        62 | 59.38K | 1058 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'52'' | 0:01'03'' |
| Q30L60X80P000  |   80.0 |  98.91% |     52697 | 4.52M | 158 |        41 | 34.19K |  872 |   79.0 | 2.0 |  20.0 | 127.5 | "31,41,51,61,71,81" | 0:01'22'' | 0:01'06'' |
| Q30L60XallP000 |  109.7 |  98.93% |     54866 | 4.53M | 149 |        36 |  27.2K |  824 |  108.0 | 3.0 |  20.0 | 175.5 | "31,41,51,61,71,81" | 0:01'45'' | 0:01'07'' |

| Name           | CovCor | Mapped% | N50Anchor |   Sum |   # | N50Others |    Sum |    # | median | MAD | lower | upper |                Kmer | RunTimeKU | RunTimeAN |
|:---------------|-------:|--------:|----------:|------:|----:|----------:|-------:|-----:|-------:|----:|------:|------:|--------------------:|----------:|----------:|
| Q25L60X40P000  |   40.0 |  98.82% |     49083 | 4.52M | 154 |        51 | 47.19K |  992 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'52'' | 0:01'04'' |
| Q25L60X40P001  |   40.0 |  98.74% |     48078 | 4.52M | 165 |        53 | 47.01K |  958 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'51'' | 0:01'02'' |
| Q25L60X80P000  |   80.0 |  98.74% |     52015 | 4.52M | 154 |        38 | 30.45K |  840 |   78.0 | 2.0 |  20.0 | 126.0 | "31,41,51,61,71,81" | 0:01'22'' | 0:01'05'' |
| Q25L60XallP000 |  117.2 |  98.70% |     46779 | 4.53M | 170 |        31 | 23.05K |  808 |  115.0 | 3.0 |  20.0 | 186.0 | "31,41,51,61,71,81" | 0:01'48'' | 0:01'07'' |
| Q30L60X40P000  |   40.0 |  98.81% |     41145 | 4.52M | 199 |        54 | 64.88K | 1324 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" | 0:00'49'' | 0:01'04'' |
| Q30L60X40P001  |   40.0 |  98.78% |     38582 | 4.52M | 199 |        48 |  58.3K | 1309 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" | 0:00'49'' | 0:01'02'' |
| Q30L60X80P000  |   80.0 |  98.83% |     48233 | 4.52M | 166 |        37 | 36.86K | 1068 |   78.0 | 3.0 |  20.0 | 130.5 | "31,41,51,61,71,81" | 0:01'16'' | 0:01'06'' |
| Q30L60XallP000 |   98.6 |  98.86% |     49133 | 4.52M | 159 |        35 | 33.23K | 1026 |   96.0 | 4.0 |  20.0 | 162.0 | "31,41,51,61,71,81" | 0:01'28'' | 0:01'07'' |

* Tadpole

| Name           | CovCor | Mapped% | N50Anchor |   Sum |   # | N50Others |    Sum |    # | median | MAD | lower | upper |                Kmer | RunTimeKU | RunTimeAN |
|:---------------|-------:|--------:|----------:|------:|----:|----------:|-------:|-----:|-------:|----:|------:|------:|--------------------:|----------:|----------:|
| Q25L60X40P000  |   40.0 |  98.82% |     54567 | 4.52M | 157 |        59 | 55.97K |  953 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'42'' | 0:01'03'' |
| Q25L60X40P001  |   40.0 |  98.87% |     52702 | 4.52M | 159 |        50 | 41.56K |  914 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'42'' | 0:01'03'' |
| Q25L60X40P002  |   40.0 |  98.87% |     48385 | 4.52M | 165 |        51 | 41.36K |  883 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'41'' | 0:01'03'' |
| Q25L60X80P000  |   80.0 |  98.75% |     50700 | 4.52M | 156 |        45 |  32.6K |  736 |   78.0 | 2.0 |  20.0 | 126.0 | "31,41,51,61,71,81" | 0:00'50'' | 0:01'02'' |
| Q25L60XallP000 |  123.1 |  98.67% |     39099 | 4.53M | 194 |        32 | 22.69K |  731 |  121.0 | 3.0 |  20.0 | 195.0 | "31,41,51,61,71,81" | 0:01'00'' | 0:01'00'' |
| Q30L60X40P000  |   40.0 |  98.84% |     40014 | 4.52M | 208 |        43 | 48.44K | 1244 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" | 0:00'41'' | 0:01'03'' |
| Q30L60X40P001  |   40.0 |  98.88% |     35553 | 4.52M | 208 |        48 | 59.86K | 1292 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" | 0:00'41'' | 0:01'03'' |
| Q30L60X80P000  |   80.0 |  98.91% |     48082 | 4.52M | 167 |        41 |  37.4K |  973 |   78.0 | 3.0 |  20.0 | 130.5 | "31,41,51,61,71,81" | 0:00'50'' | 0:01'08'' |
| Q30L60XallP000 |  109.7 |  98.92% |     49147 | 4.53M | 161 |        33 | 27.16K |  905 |  108.0 | 4.0 |  20.0 | 180.0 | "31,41,51,61,71,81" | 0:00'57'' | 0:01'08'' |

| Name           | CovCor | Mapped% | N50Anchor |   Sum |   # | N50Others |    Sum |    # | median | MAD | lower | upper |                Kmer | RunTimeKU | RunTimeAN |
|:---------------|-------:|--------:|----------:|------:|----:|----------:|-------:|-----:|-------:|----:|------:|------:|--------------------:|----------:|----------:|
| Q25L60X40P000  |   40.0 |  98.82% |     44580 | 4.52M | 172 |        53 | 61.73K | 1208 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'41'' | 0:01'04'' |
| Q25L60X40P001  |   40.0 |  98.82% |     48077 | 4.52M | 172 |        55 | 66.53K | 1222 |   39.0 | 1.0 |  12.0 |  63.0 | "31,41,51,61,71,81" | 0:00'41'' | 0:01'06'' |
| Q25L60X80P000  |   80.0 |  98.81% |     53683 | 4.52M | 150 |        37 | 30.89K |  928 |   79.0 | 2.0 |  20.0 | 127.5 | "31,41,51,61,71,81" | 0:00'50'' | 0:01'09'' |
| Q25L60XallP000 |  117.2 |  98.81% |     56385 | 4.53M | 149 |        28 | 20.86K |  852 |  115.0 | 3.0 |  20.0 | 186.0 | "31,41,51,61,71,81" | 0:00'57'' | 0:01'09'' |
| Q30L60X40P000  |   40.0 |  98.78% |     30932 | 4.52M | 255 |       112 |    91K | 1619 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" | 0:00'42'' | 0:01'03'' |
| Q30L60X40P001  |   40.0 |  98.72% |     30970 | 4.52M | 242 |        51 | 73.79K | 1553 |   39.0 | 2.0 |  11.0 |  67.5 | "31,41,51,61,71,81" | 0:00'41'' | 0:01'01'' |
| Q30L60X80P000  |   80.0 |  98.80% |     40154 | 4.53M | 191 |        36 | 41.42K | 1236 |   78.0 | 4.0 |  20.0 | 135.0 | "31,41,51,61,71,81" | 0:00'51'' | 0:01'07'' |
| Q30L60XallP000 |   98.6 |  98.80% |     42240 | 4.52M | 181 |        33 | 36.04K | 1180 |   96.0 | 4.0 |  20.0 | 162.0 | "31,41,51,61,71,81" | 0:00'55'' | 0:01'06'' |


## Comparison

| Name                           |     N50 |     Sum |   # |
|:-------------------------------|--------:|--------:|----:|
| Genome                         | 4641652 | 4641652 |   1 |
| Paralogs                       |    1934 |  195673 | 106 |
| 6_mergeKunitigsAnchors.anchors |   63138 | 4528751 | 125 |
| 6_mergeKunitigsAnchors.others  |    1345 |   40248 |  33 |
| 6_mergeTadpoleAnchors.anchors  |   63594 | 4529697 | 123 |
| 6_mergeTadpoleAnchors.others   |    1550 |   70762 |  47 |
| 6_mergeAnchors.anchors         |   63594 | 4529697 | 123 |
| 6_mergeAnchors.others          |    1550 |   70762 |  47 |
| spades.contig                  |   97656 | 4644120 | 260 |
| spades.scaffold                |  112078 | 4644620 | 255 |
| spades.non-contained           |  106190 | 4581541 | 107 |
| spades.anchor                  |  105566 | 4536072 |  83 |
| megahit.contig                 |   48073 | 4573710 | 240 |
| megahit.non-contained          |   48073 | 4547903 | 171 |
| megahit.anchor                 |   48017 | 4524164 | 162 |
| platanus.contig                |   43810 | 4612721 | 835 |
| platanus.non-contained         |   44625 | 4524161 | 188 |
| platanus.anchor                |   46255 | 4511694 | 184 |


| Name                           |     N50 |     Sum |   # |
|:-------------------------------|--------:|--------:|----:|
| Genome                         | 4641652 | 4641652 |   1 |
| Paralogs                       |    1934 |  195673 | 106 |
| 6_mergeKunitigsAnchors.anchors |   63410 | 4527839 | 128 |
| 6_mergeKunitigsAnchors.others  |    1349 |   55257 |  44 |
| 6_mergeTadpoleAnchors.anchors  |   63518 | 4528369 | 127 |
| 6_mergeTadpoleAnchors.others   |    1472 |   95920 |  68 |
| 6_mergeAnchors.anchors         |   63518 | 4528369 | 127 |
| 6_mergeAnchors.others          |    1472 |   95920 |  68 |
| spades.contig                  |   97659 | 4656299 | 272 |
| spades.scaffold                |  106190 | 4656699 | 268 |
| spades.non-contained           |  106190 | 4587374 | 110 |
| spades.anchor                  |  105552 | 4537190 |  82 |
| megahit.contig                 |   46296 | 4572712 | 244 |
| megahit.non-contained          |   46553 | 4548316 | 175 |
| megahit.anchor                 |   46516 | 4523837 | 167 |
| platanus.contig                |   38596 | 4612108 | 929 |
| platanus.non-contained         |   39095 | 4519722 | 207 |
| platanus.anchor                |   39040 | 4506077 | 205 |
