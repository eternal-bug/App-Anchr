# Tuning parameters for the dataset of *E. coli*

[TOC level=1-3]: # " "
- [Tuning parameters for the dataset of *E. coli*](#tuning-parameters-for-the-dataset-of-e-coli)
- [*Escherichia coli* str. K-12 substr. MG1655](#escherichia-coli-str-k-12-substr-mg1655)
    - [Symlinks](#symlinks)
    - [Combinations of different quality values and read lengths](#combinations-of-different-quality-values-and-read-lengths)
    - [Down sampling](#down-sampling)
    - [Generate super-reads](#generate-super-reads)
    - [Create anchors](#create-anchors)
    - [Results](#results)
    - [Quality assessment](#quality-assessment)


# *Escherichia coli* str. K-12 substr. MG1655

* Genome: INSDC [U00096.3](https://www.ncbi.nlm.nih.gov/nuccore/U00096.3)
* Proportion of paralogs: 0.0323

## Symlinks

```bash
mkdir -p ~/data/anchr/e_coli_tuning/1_genome
cd ~/data/anchr/e_coli_tuning/1_genome

ln -s ~/data/anchr/e_coli/1_genome/genome.fa genome.fa

mkdir -p ~/data/anchr/e_coli_tuning/2_illumina
cd ~/data/anchr/e_coli_tuning/2_illumina

ln -s ~/data/anchr/e_coli/2_illumina/R1.fq.gz R1.fq.gz
ln -s ~/data/anchr/e_coli/2_illumina/R2.fq.gz R2.fq.gz

ln -s ~/data/anchr/e_coli/2_illumina/R1.scythe.fq.gz R1.scythe.fq.gz
ln -s ~/data/anchr/e_coli/2_illumina/R2.scythe.fq.gz R2.scythe.fq.gz

mkdir -p ~/data/anchr/e_coli_tuning/3_pacbio
cd ~/data/anchr/e_coli_tuning/3_pacbio

ln -s ~/data/anchr/e_coli/3_pacbio/pacbio.fasta pacbio.fasta
```

## Combinations of different quality values and read lengths

* qual: 20, 25, and 30
* len: 120, 130, 140 and 151

```bash
BASE_DIR=$HOME/data/anchr/e_coli_tuning
cd ${BASE_DIR}

cd ${BASE_DIR}
for qual in 20 25 30; do
    for len in 120 130 140 150; do
        DIR_COUNT="${BASE_DIR}/2_illumina/Q${qual}L${len}"
        
        mkdir -p ${DIR_COUNT}
        pushd ${DIR_COUNT}
        
        anchr trim \
            --noscythe \
            -q ${qual} -l ${len} \
            ../R1.scythe.fq.gz ../R2.scythe.fq.gz \
            -o stdout \
            | bash

        popd
    done
done

# clear dirs stack
dirs -c
```

* Stats

```bash
cd ~/data/anchr/e_coli_tuning

printf "| %s | %s | %s | %s |\n" \
    "Name" "N50" "Sum" "#" \
    > stat.md
printf "|:--|--:|--:|--:|\n" >> stat.md

printf "| %s | %s | %s | %s |\n" \
    $(echo "Genome";   faops n50 -H -S -C 1_genome/genome.fa;) >> stat.md
printf "| %s | %s | %s | %s |\n" \
    $(echo "Illumina"; faops n50 -H -S -C 2_illumina/R1.fq.gz 2_illumina/R2.fq.gz;) >> stat.md
printf "| %s | %s | %s | %s |\n" \
    $(echo "PacBio";   faops n50 -H -S -C 3_pacbio/pacbio.fasta;) >> stat.md
printf "| %s | %s | %s | %s |\n" \
    $(echo "scythe";   faops n50 -H -S -C 2_illumina/R1.scythe.fq.gz 2_illumina/R2.scythe.fq.gz;) >> stat.md

for qual in 20 25 30; do
    for len in 120 130 140 150; do
        DIR_COUNT="${BASE_DIR}/2_illumina/Q${qual}L${len}"

        printf "| %s | %s | %s | %s |\n" \
            $(echo "Q${qual}L${len}"; faops n50 -H -S -C ${DIR_COUNT}/R1.fq.gz  ${DIR_COUNT}/R2.fq.gz;) \
            >> stat.md
    done
done

cat stat.md
```

| Name     |     N50 |        Sum |        # |
|:---------|--------:|-----------:|---------:|
| Genome   | 4641652 |    4641652 |        1 |
| Illumina |     151 | 1730299940 | 11458940 |
| PacBio   |   13982 |  748508361 |    87225 |
| scythe   |     151 | 1724565376 | 11458940 |
| Q20L120  |     151 | 1138097252 |  7742646 |
| Q20L130  |     151 |  977384738 |  6561892 |
| Q20L140  |     151 |  786030615 |  5213876 |
| Q20L150  |     151 |  742742028 |  4918836 |
| Q25L120  |     151 |  839150352 |  5820278 |
| Q25L130  |     151 |  634128805 |  4303670 |
| Q25L140  |     151 |  421124326 |  2798656 |
| Q25L150  |     151 |  373356309 |  2472564 |
| Q30L120  |     140 |  383365150 |  2755884 |
| Q30L130  |     151 |  211952097 |  1468318 |
| Q30L140  |     151 |   92578231 |   617860 |
| Q30L150  |     151 |   69756203 |   461964 |

## Down sampling

过高的 coverage 会造成不好的影响. SGA 的文档里也说了类似的事情.

> Very highly-represented sequences (>1000X) can cause problems for SGA... In these cases, it is
> worth considering pre-filtering the data...

```bash
BASE_DIR=$HOME/data/anchr/e_coli_tuning
cd ${BASE_DIR}

# works on bash 3
ARRAY=( "2_illumina:original:4000000"
        "2_illumina/Q20L120:Q20L120:3800000"
        "2_illumina/Q20L130:Q20L130:3200000"
        "2_illumina/Q20L140:Q20L140:2600000"
        "2_illumina/Q20L150:Q20L150:2400000"
        "2_illumina/Q25L120:Q25L120:2800000"
        "2_illumina/Q25L130:Q25L130:2000000"
        "2_illumina/Q25L140:Q25L140:1200000"
        "2_illumina/Q25L150:Q25L150:1200000"
        "2_illumina/Q30L120:Q30L120:1200000"
        "2_illumina/Q30L130:Q30L130:600000"
        "2_illumina/Q30L140:Q30L140:200000"
        "2_illumina/Q30L150:Q30L150:200000")

for group in "${ARRAY[@]}" ; do
    
    GROUP_DIR=$(group=${group} perl -e '@p = split q{:}, $ENV{group}; print $p[0];')
    GROUP_ID=$( group=${group} perl -e '@p = split q{:}, $ENV{group}; print $p[1];')
    GROUP_MAX=$(group=${group} perl -e '@p = split q{:}, $ENV{group}; print $p[2];')
    printf "==> %s \t %s \t %s\n" "$GROUP_DIR" "$GROUP_ID" "$GROUP_MAX"

    for count in $(perl -e 'print 200000 * $_, q{ } for 1 .. 20');
    do
        if [[ "$count" -gt "$GROUP_MAX" ]]; then
            continue     
        fi
        
        echo "==> Group ${GROUP_ID}_${count}"
        DIR_COUNT="${BASE_DIR}/${GROUP_ID}_${count}"
        mkdir -p ${DIR_COUNT}
        
        if [ -e ${DIR_COUNT}/R1.fq.gz ]; then
            continue     
        fi
        
        seqtk sample -s${count} \
            ${BASE_DIR}/${GROUP_DIR}/R1.fq.gz ${count} \
            | pigz > ${DIR_COUNT}/R1.fq.gz
        seqtk sample -s${count} \
            ${BASE_DIR}/${GROUP_DIR}/R2.fq.gz ${count} \
            | pigz > ${DIR_COUNT}/R2.fq.gz
    done
done
```

## Generate super-reads

```bash
BASE_DIR=$HOME/data/anchr/e_coli_tuning
cd ${BASE_DIR}

for d in $(perl -e 'for $n (qw{original Q20L120 Q20L130 Q20L140 Q20L150 Q25L120 Q25L130 Q25L140 Q25L150 Q30L120 Q30L130 Q30L140 Q30L150}) { for $i (1 .. 25) { printf qq{%s_%d }, $n, (200000 * $i); } }');
do
    echo
    DIR_COUNT="${BASE_DIR}/${d}/"

    if [ ! -d ${DIR_COUNT} ]; then
        continue
    fi
    
    echo "==> Group ${DIR_COUNT}"

    if [ -e ${DIR_COUNT}/pe.cor.fa ]; then
        echo "    pe.cor.fa already presents"
        continue
    fi
    
    pushd ${DIR_COUNT} > /dev/null
    anchr superreads \
        R1.fq.gz \
        R2.fq.gz \
        --nosr \
        -s 300 -d 30 -p 16
    bash superreads.sh
    popd > /dev/null
done
```

Clear intermediate files.

```bash
cd $HOME/data/anchr/e_coli_tuning

find . -type f -name "quorum_mer_db.jf" | xargs rm
find . -type f -name "k_u_hash_0" | xargs rm
find . -type f -name "readPositionsInSuperReads" | xargs rm
find . -type f -name "*.tmp" | xargs rm
#find . -type f -name "pe.renamed.fastq" | xargs rm
```

## Create anchors

```bash
BASE_DIR=$HOME/data/anchr/e_coli_tuning
cd ${BASE_DIR}

for d in $(perl -e 'for $n (qw{original Q20L120 Q20L130 Q20L140 Q20L150 Q25L120 Q25L130 Q25L140 Q25L150 Q30L120 Q30L130 Q30L140 Q30L150}) { for $i (1 .. 25) { printf qq{%s_%d }, $n, (200000 * $i); } }');
do
    echo
    echo "==> Reads ${d}"
    DIR_COUNT="${BASE_DIR}/${d}/"
    
    if [ -e ${DIR_COUNT}/anchor/pe.anchor.fa ]; then
        continue
    fi

    rm -fr ${DIR_COUNT}/anchor
    bash ~/Scripts/cpan/App-Anchr/share/anchor.sh ${DIR_COUNT} 16 120 false
done
```

## Results

* Stats of super-reads

```bash
BASE_DIR=$HOME/data/anchr/e_coli_tuning
cd ${BASE_DIR}

REAL_G=4641652

bash ~/Scripts/cpan/App-Anchr/share/sr_stat.sh 1 header \
    > ${BASE_DIR}/stat1.md

for d in $(perl -e 'for $n (qw{original Q20L120 Q20L130 Q20L140 Q20L150 Q25L120 Q25L130 Q25L140 Q25L150 Q30L120 Q30L130 Q30L140 Q30L150}) { for $i (1 .. 25) { printf qq{%s_%d }, $n, (200000 * $i); } }');
do
    DIR_COUNT="${BASE_DIR}/${d}/"
    
    if [ ! -d ${DIR_COUNT} ]; then
        continue     
    fi
    
    bash ~/Scripts/cpan/App-Anchr/share/sr_stat.sh 1 ${DIR_COUNT} ${REAL_G} \
        >> ${BASE_DIR}/stat1.md
done

cat stat1.md
```

* Stats of anchors

```bash
BASE_DIR=$HOME/data/anchr/e_coli_tuning
cd ${BASE_DIR}

bash ~/Scripts/cpan/App-Anchr/share/sr_stat.sh 2 header \
    > ${BASE_DIR}/stat2.md

for d in $(perl -e 'for $n (qw{original Q20L120 Q20L130 Q20L140 Q20L150 Q25L120 Q25L130 Q25L140 Q25L150 Q30L120 Q30L130 Q30L140 Q30L150}) { for $i (1 .. 25) { printf qq{%s_%d }, $n, (200000 * $i); } }');
do
    DIR_COUNT="${BASE_DIR}/${d}/"
    
    if [ ! -e ${DIR_COUNT}/anchor/pe.anchor.fa ]; then
        continue     
    fi
    
    bash ~/Scripts/cpan/App-Anchr/share/sr_stat.sh 2 ${DIR_COUNT} \
        >> ${BASE_DIR}/stat2.md

done

cat stat2.md
```

| Name             |   SumFq | CovFq | AvgRead | Kmer |   SumFa | Discard% | RealG |  EstG | Est/Real |  SumKU | SumSR |   RunTime |
|:-----------------|--------:|------:|--------:|-----:|--------:|---------:|------:|------:|---------:|-------:|------:|----------:|
| original_200000  |   60.4M |  13.0 |     151 |   75 |  38.25M |  36.669% | 4.64M | 4.45M |     0.96 |  4.74M |     0 | 0:00'35'' |
| original_400000  |  120.8M |  26.0 |     151 |   75 |  76.08M |  37.018% | 4.64M | 4.57M |     0.98 |  4.94M |     0 | 0:00'51'' |
| original_600000  |  181.2M |  39.0 |     151 |   75 | 114.43M |  36.851% | 4.64M |  4.6M |     0.99 |  5.23M |     0 | 0:01'07'' |
| original_800000  |  241.6M |  52.1 |     151 |   75 | 153.19M |  36.593% | 4.64M | 4.64M |     1.00 |  5.58M |     0 | 0:01'28'' |
| original_1000000 |    302M |  65.1 |     151 |   75 | 192.04M |  36.411% | 4.64M | 4.68M |     1.01 |  5.99M |     0 | 0:01'30'' |
| original_1200000 |  362.4M |  78.1 |     151 |   75 | 231.29M |  36.177% | 4.64M | 4.72M |     1.02 |  6.49M |     0 | 0:01'33'' |
| original_1400000 |  422.8M |  91.1 |     151 |   75 | 270.56M |  36.008% | 4.64M | 4.77M |     1.03 |  7.03M |     0 | 0:01'43'' |
| original_1600000 |  483.2M | 104.1 |     151 |   75 | 309.73M |  35.900% | 4.64M | 4.83M |     1.04 |  7.61M |     0 | 0:02'00'' |
| original_1800000 |  543.6M | 117.1 |     151 |   75 | 349.44M |  35.717% | 4.64M | 4.88M |     1.05 |   8.2M |     0 | 0:02'20'' |
| original_2000000 |    604M | 130.1 |     151 |   75 | 389.03M |  35.591% | 4.64M | 4.94M |     1.06 |  8.95M |     0 | 0:02'30'' |
| original_2200000 |  664.4M | 143.1 |     151 |   75 | 428.95M |  35.438% | 4.64M | 5.01M |     1.08 |  9.75M |     0 | 0:02'44'' |
| original_2400000 |  724.8M | 156.2 |     151 |   75 | 469.08M |  35.282% | 4.64M | 5.08M |     1.09 | 10.67M |     0 | 0:03'04'' |
| original_2600000 |  785.2M | 169.2 |     151 |   75 | 508.97M |  35.180% | 4.64M | 5.15M |     1.11 | 11.65M |     0 | 0:03'31'' |
| original_2800000 |  845.6M | 182.2 |     151 |   75 |  549.2M |  35.052% | 4.64M | 5.22M |     1.12 | 12.87M |     0 | 0:03'25'' |
| original_3000000 |    906M | 195.2 |     151 |   75 | 589.74M |  34.907% | 4.64M |  5.3M |     1.14 | 14.26M |     0 | 0:03'44'' |
| original_3200000 |  966.4M | 208.2 |     151 |   75 |  630.1M |  34.799% | 4.64M | 5.38M |     1.16 |  15.8M |     0 | 0:04'04'' |
| original_3400000 |   1.03G | 221.2 |     151 |   75 | 671.04M |  34.648% | 4.64M | 5.47M |     1.18 |  17.6M |     0 | 0:04'23'' |
| original_3600000 |   1.09G | 234.2 |     151 |   75 | 711.81M |  34.528% | 4.64M | 5.56M |     1.20 | 19.81M |     0 | 0:04'30'' |
| original_3800000 |   1.15G | 247.2 |     151 |   75 | 752.53M |  34.426% | 4.64M | 5.65M |     1.22 | 22.19M |     0 | 0:04'37'' |
| original_4000000 |   1.21G | 260.3 |     151 |   75 | 793.52M |  34.311% | 4.64M | 5.74M |     1.24 | 24.98M |     0 | 0:04'53'' |
| Q20L120_200000   |  58.79M |  12.7 |     147 |  105 |  51.18M |  12.949% | 4.64M | 4.46M |     0.96 |  5.33M |     0 | 0:00'37'' |
| Q20L120_400000   |  117.6M |  25.3 |     147 |  105 | 102.19M |  13.104% | 4.64M | 4.54M |     0.98 |   4.9M |     0 | 0:00'46'' |
| Q20L120_600000   | 176.38M |  38.0 |     146 |  105 | 153.28M |  13.097% | 4.64M | 4.55M |     0.98 |  4.78M |     0 | 0:01'13'' |
| Q20L120_800000   | 235.18M |  50.7 |     146 |  105 | 204.42M |  13.080% | 4.64M | 4.55M |     0.98 |  4.71M |     0 | 0:01'14'' |
| Q20L120_1000000  | 293.99M |  63.3 |     146 |  105 | 255.42M |  13.119% | 4.64M | 4.56M |     0.98 |  4.71M |     0 | 0:01'34'' |
| Q20L120_1200000  | 352.79M |  76.0 |     146 |  105 | 306.49M |  13.123% | 4.64M | 4.56M |     0.98 |  4.72M |     0 | 0:01'28'' |
| Q20L120_1400000  | 411.57M |  88.7 |     146 |  105 | 357.63M |  13.107% | 4.64M | 4.56M |     0.98 |  4.74M |     0 | 0:01'40'' |
| Q20L120_1600000  | 470.38M | 101.3 |     146 |  105 | 408.87M |  13.076% | 4.64M | 4.56M |     0.98 |  4.75M |     0 | 0:01'51'' |
| Q20L120_1800000  | 529.16M | 114.0 |     146 |  105 | 459.95M |  13.079% | 4.64M | 4.57M |     0.98 |  4.79M |     0 | 0:01'58'' |
| Q20L120_2000000  | 587.97M | 126.7 |     146 |  105 | 511.21M |  13.056% | 4.64M | 4.57M |     0.99 |  4.82M |     0 | 0:02'13'' |
| Q20L120_2200000  | 646.76M | 139.3 |     146 |  105 | 562.37M |  13.048% | 4.64M | 4.58M |     0.99 |  4.86M |     0 | 0:02'26'' |
| Q20L120_2400000  | 705.56M | 152.0 |     146 |  105 | 613.66M |  13.024% | 4.64M | 4.58M |     0.99 |  4.92M |     0 | 0:02'27'' |
| Q20L120_2600000  | 764.34M | 164.7 |     146 |  105 | 664.85M |  13.017% | 4.64M | 4.59M |     0.99 |  4.98M |     0 | 0:02'39'' |
| Q20L120_2800000  | 823.13M | 177.3 |     145 |  101 | 716.22M |  12.988% | 4.64M | 4.59M |     0.99 |  5.02M |     0 | 0:02'50'' |
| Q20L120_3000000  | 881.96M | 190.0 |     145 |  101 | 767.44M |  12.985% | 4.64M |  4.6M |     0.99 |  5.08M |     0 | 0:03'01'' |
| Q20L120_3200000  | 940.75M | 202.7 |     145 |  101 |  818.8M |  12.963% | 4.64M |  4.6M |     0.99 |  5.14M |     0 | 0:03'20'' |
| Q20L120_3400000  | 999.54M | 215.3 |     145 |   99 | 870.05M |  12.955% | 4.64M | 4.61M |     0.99 |  5.21M |     0 | 0:03'30'' |
| Q20L120_3600000  |   1.06G | 228.0 |     145 |   99 | 921.51M |  12.928% | 4.64M | 4.62M |     0.99 |  5.29M |     0 | 0:03'46'' |
| Q20L120_3800000  |   1.12G | 240.7 |     145 |   99 | 972.93M |  12.908% | 4.64M | 4.62M |     1.00 |  5.38M |     0 | 0:04'42'' |
| Q20L130_200000   |  59.58M |  12.8 |     149 |  105 |  51.88M |  12.920% | 4.64M |  4.4M |     0.95 |  5.17M |     0 | 0:00'32'' |
| Q20L130_400000   | 119.17M |  25.7 |     148 |  105 | 103.52M |  13.125% | 4.64M | 4.52M |     0.97 |  4.85M |     0 | 0:00'49'' |
| Q20L130_600000   | 178.73M |  38.5 |     148 |  105 | 155.23M |  13.150% | 4.64M | 4.54M |     0.98 |  4.76M |     0 | 0:01'06'' |
| Q20L130_800000   | 238.32M |  51.3 |     148 |  105 | 207.08M |  13.110% | 4.64M | 4.55M |     0.98 |  4.72M |     0 | 0:01'07'' |
| Q20L130_1000000  | 297.89M |  64.2 |     148 |  105 | 258.74M |  13.143% | 4.64M | 4.55M |     0.98 |  4.71M |     0 | 0:01'35'' |
| Q20L130_1200000  | 357.48M |  77.0 |     148 |  105 | 310.32M |  13.192% | 4.64M | 4.56M |     0.98 |  4.71M |     0 | 0:01'40'' |
| Q20L130_1400000  | 417.05M |  89.8 |     148 |  105 | 362.23M |  13.144% | 4.64M | 4.56M |     0.98 |  4.73M |     0 | 0:01'54'' |
| Q20L130_1600000  | 476.63M | 102.7 |     148 |  105 |    414M |  13.139% | 4.64M | 4.56M |     0.98 |  4.75M |     0 | 0:02'03'' |
| Q20L130_1800000  |  536.2M | 115.5 |     148 |  105 | 465.84M |  13.123% | 4.64M | 4.57M |     0.98 |  4.78M |     0 | 0:02'35'' |
| Q20L130_2000000  | 595.79M | 128.4 |     148 |  105 | 517.68M |  13.111% | 4.64M | 4.57M |     0.98 |  4.81M |     0 | 0:02'44'' |
| Q20L130_2200000  | 655.38M | 141.2 |     148 |  105 | 569.69M |  13.074% | 4.64M | 4.57M |     0.99 |  4.86M |     0 | 0:02'16'' |
| Q20L130_2400000  | 714.95M | 154.0 |     148 |  105 | 621.51M |  13.070% | 4.64M | 4.58M |     0.99 |  4.91M |     0 | 0:02'27'' |
| Q20L130_2600000  | 774.53M | 166.9 |     148 |  105 | 673.44M |  13.052% | 4.64M | 4.58M |     0.99 |  4.95M |     0 | 0:02'38'' |
| Q20L130_2800000  | 834.11M | 179.7 |     148 |  105 |  725.3M |  13.045% | 4.64M | 4.59M |     0.99 |  5.01M |     0 | 0:02'48'' |
| Q20L130_3000000  | 893.69M | 192.5 |     148 |  105 | 777.33M |  13.021% | 4.64M | 4.59M |     0.99 |  5.07M |     0 | 0:03'01'' |
| Q20L130_3200000  | 953.27M | 205.4 |     147 |  105 | 829.27M |  13.008% | 4.64M | 4.59M |     0.99 |  5.13M |     0 | 0:03'14'' |
| Q20L140_200000   |   60.3M |  13.0 |     150 |  105 |  52.32M |  13.236% | 4.64M | 4.31M |     0.93 |  4.98M |     0 | 0:00'31'' |
| Q20L140_400000   | 120.61M |  26.0 |     150 |  105 |  104.6M |  13.269% | 4.64M | 4.49M |     0.97 |  4.82M |     0 | 0:01'14'' |
| Q20L140_600000   | 180.91M |  39.0 |     150 |  105 | 156.81M |  13.323% | 4.64M | 4.52M |     0.97 |  4.75M |     0 | 0:01'20'' |
| Q20L140_800000   | 241.21M |  52.0 |     150 |  105 | 208.99M |  13.357% | 4.64M | 4.53M |     0.98 |  4.71M |     0 | 0:01'29'' |
| Q20L140_1000000  | 301.52M |  65.0 |     150 |  105 | 261.39M |  13.307% | 4.64M | 4.54M |     0.98 |  4.71M |     0 | 0:01'27'' |
| Q20L140_1200000  | 361.82M |  77.9 |     150 |  105 | 313.62M |  13.321% | 4.64M | 4.55M |     0.98 |  4.71M |     0 | 0:02'13'' |
| Q20L140_1400000  | 422.12M |  90.9 |     150 |  105 | 365.95M |  13.307% | 4.64M | 4.55M |     0.98 |  4.73M |     0 | 0:01'49'' |
| Q20L140_1600000  | 482.42M | 103.9 |     150 |  105 | 418.21M |  13.311% | 4.64M | 4.55M |     0.98 |  4.75M |     0 | 0:02'59'' |
| Q20L140_1800000  | 542.73M | 116.9 |     150 |  105 |  470.7M |  13.271% | 4.64M | 4.56M |     0.98 |  4.78M |     0 | 0:02'45'' |
| Q20L140_2000000  | 603.03M | 129.9 |     150 |  105 | 523.06M |  13.261% | 4.64M | 4.56M |     0.98 |  4.81M |     0 | 0:02'53'' |
| Q20L140_2200000  | 663.33M | 142.9 |     150 |  105 | 575.41M |  13.254% | 4.64M | 4.57M |     0.98 |  4.85M |     0 | 0:02'50'' |
| Q20L140_2400000  | 723.64M | 155.9 |     150 |  105 | 627.81M |  13.242% | 4.64M | 4.57M |     0.98 |  4.89M |     0 | 0:03'02'' |
| Q20L140_2600000  | 783.94M | 168.9 |     150 |  105 | 680.26M |  13.225% | 4.64M | 4.57M |     0.99 |  4.94M |     0 | 0:03'51'' |
| Q20L150_200000   |   60.4M |  13.0 |     150 |  105 |  52.47M |  13.133% | 4.64M | 4.28M |     0.92 |  4.94M |     0 | 0:00'41'' |
| Q20L150_400000   |  120.8M |  26.0 |     150 |  105 | 104.77M |  13.271% | 4.64M | 4.47M |     0.96 |  4.81M |     0 | 0:01'18'' |
| Q20L150_600000   |  181.2M |  39.0 |     150 |  105 | 157.13M |  13.283% | 4.64M | 4.51M |     0.97 |  4.74M |     0 | 0:00'55'' |
| Q20L150_800000   |  241.6M |  52.1 |     150 |  105 | 209.46M |  13.301% | 4.64M | 4.53M |     0.98 |  4.72M |     0 | 0:02'05'' |
| Q20L150_1000000  |    302M |  65.1 |     150 |  105 | 261.92M |  13.272% | 4.64M | 4.54M |     0.98 |  4.71M |     0 | 0:01'39'' |
| Q20L150_1200000  |  362.4M |  78.1 |     150 |  105 | 314.43M |  13.237% | 4.64M | 4.54M |     0.98 |  4.71M |     0 | 0:01'47'' |
| Q20L150_1400000  |  422.8M |  91.1 |     150 |  105 | 366.73M |  13.262% | 4.64M | 4.55M |     0.98 |  4.73M |     0 | 0:02'07'' |
| Q20L150_1600000  |  483.2M | 104.1 |     150 |  105 |  419.2M |  13.245% | 4.64M | 4.55M |     0.98 |  4.75M |     0 | 0:02'07'' |
| Q20L150_1800000  |  543.6M | 117.1 |     150 |  105 | 471.78M |  13.212% | 4.64M | 4.55M |     0.98 |  4.77M |     0 | 0:02'27'' |
| Q20L150_2000000  |    604M | 130.1 |     150 |  105 | 524.15M |  13.219% | 4.64M | 4.56M |     0.98 |   4.8M |     0 | 0:02'49'' |
| Q20L150_2200000  |  664.4M | 143.1 |     150 |  105 | 576.74M |  13.194% | 4.64M | 4.56M |     0.98 |  4.83M |     0 | 0:03'37'' |
| Q20L150_2400000  |  724.8M | 156.2 |     150 |  105 |  629.2M |  13.190% | 4.64M | 4.57M |     0.98 |  4.88M |     0 | 0:03'14'' |
| Q25L120_200000   |  57.66M |  12.4 |     144 |   95 |   54.1M |   6.179% | 4.64M | 4.38M |     0.94 |  4.88M |     0 | 0:00'37'' |
| Q25L120_400000   | 115.35M |  24.9 |     144 |   95 |  108.3M |   6.114% | 4.64M | 4.51M |     0.97 |  4.75M |     0 | 0:00'53'' |
| Q25L120_600000   | 173.01M |  37.3 |     144 |   95 | 162.51M |   6.069% | 4.64M | 4.54M |     0.98 |   4.7M |     0 | 0:01'19'' |
| Q25L120_800000   |  230.7M |  49.7 |     143 |   95 | 216.66M |   6.083% | 4.64M | 4.55M |     0.98 |  4.68M |     0 | 0:01'18'' |
| Q25L120_1000000  | 288.36M |  62.1 |     143 |   93 | 270.81M |   6.088% | 4.64M | 4.55M |     0.98 |  4.67M |     0 | 0:01'38'' |
| Q25L120_1200000  | 346.02M |  74.5 |     143 |   93 | 324.97M |   6.086% | 4.64M | 4.55M |     0.98 |  4.67M |     0 | 0:01'46'' |
| Q25L120_1400000  | 403.68M |  87.0 |     143 |   93 | 379.07M |   6.096% | 4.64M | 4.55M |     0.98 |  4.67M |     0 | 0:02'17'' |
| Q25L120_1600000  | 461.35M |  99.4 |     143 |   93 |  433.3M |   6.080% | 4.64M | 4.56M |     0.98 |  4.67M |     0 | 0:02'24'' |
| Q25L120_1800000  | 519.04M | 111.8 |     143 |   93 | 487.46M |   6.085% | 4.64M | 4.56M |     0.98 |  4.67M |     0 | 0:02'33'' |
| Q25L120_2000000  |  576.7M | 124.2 |     143 |   93 | 541.65M |   6.077% | 4.64M | 4.56M |     0.98 |  4.67M |     0 | 0:02'54'' |
| Q25L120_2200000  | 634.37M | 136.7 |     142 |   93 | 595.83M |   6.076% | 4.64M | 4.56M |     0.98 |  4.68M |     0 | 0:03'48'' |
| Q25L120_2400000  | 692.05M | 149.1 |     142 |   93 | 649.95M |   6.083% | 4.64M | 4.56M |     0.98 |  4.68M |     0 | 0:03'22'' |
| Q25L120_2600000  | 749.72M | 161.5 |     142 |   93 |  704.1M |   6.085% | 4.64M | 4.56M |     0.98 |  4.68M |     0 | 0:03'34'' |
| Q25L120_2800000  | 807.39M | 173.9 |     142 |   93 | 758.32M |   6.077% | 4.64M | 4.56M |     0.98 |  4.68M |     0 | 0:03'59'' |
| Q25L130_200000   |  58.94M |  12.7 |     147 |  105 |  55.06M |   6.572% | 4.64M | 4.27M |     0.92 |  5.02M |     0 | 0:00'32'' |
| Q25L130_400000   | 117.87M |  25.4 |     147 |  101 | 110.35M |   6.384% | 4.64M | 4.47M |     0.96 |  4.79M |     0 | 0:01'00'' |
| Q25L130_600000   |  176.8M |  38.1 |     147 |  101 | 165.52M |   6.379% | 4.64M | 4.51M |     0.97 |  4.74M |     0 | 0:01'02'' |
| Q25L130_800000   | 235.75M |  50.8 |     146 |  101 | 220.72M |   6.374% | 4.64M | 4.53M |     0.98 |  4.71M |     0 | 0:01'31'' |
| Q25L130_1000000  | 294.68M |  63.5 |     146 |  101 | 275.93M |   6.365% | 4.64M | 4.54M |     0.98 |   4.7M |     0 | 0:01'58'' |
| Q25L130_1200000  | 353.62M |  76.2 |     146 |  101 | 331.08M |   6.374% | 4.64M | 4.54M |     0.98 |   4.7M |     0 | 0:02'04'' |
| Q25L130_1400000  | 412.57M |  88.9 |     146 |  101 | 386.28M |   6.374% | 4.64M | 4.55M |     0.98 |   4.7M |     0 | 0:02'28'' |
| Q25L130_1600000  | 471.51M | 101.6 |     146 |   99 | 441.41M |   6.384% | 4.64M | 4.55M |     0.98 |  4.69M |     0 | 0:01'58'' |
| Q25L130_1800000  | 530.45M | 114.3 |     146 |   99 | 496.67M |   6.368% | 4.64M | 4.55M |     0.98 |  4.69M |     0 | 0:02'45'' |
| Q25L130_2000000  | 589.39M | 127.0 |     146 |   99 | 551.82M |   6.374% | 4.64M | 4.55M |     0.98 |  4.69M |     0 | 0:02'59'' |
| Q25L140_200000   |  60.19M |  13.0 |     150 |  105 |  55.71M |   7.451% | 4.64M | 4.03M |     0.87 |  4.63M |     0 | 0:00'32'' |
| Q25L140_400000   | 120.38M |  25.9 |     150 |  105 | 112.03M |   6.940% | 4.64M | 4.37M |     0.94 |  4.76M |     0 | 0:01'35'' |
| Q25L140_600000   | 180.57M |  38.9 |     150 |  105 |    168M |   6.960% | 4.64M | 4.45M |     0.96 |  4.74M |     0 | 0:01'38'' |
| Q25L140_800000   | 240.76M |  51.9 |     150 |  105 | 224.15M |   6.897% | 4.64M | 4.48M |     0.96 |  4.73M |     0 | 0:01'17'' |
| Q25L140_1000000  | 300.95M |  64.8 |     150 |  105 | 280.21M |   6.890% | 4.64M |  4.5M |     0.97 |  4.72M |     0 | 0:01'47'' |
| Q25L140_1200000  | 361.14M |  77.8 |     150 |  105 | 336.21M |   6.902% | 4.64M | 4.51M |     0.97 |  4.71M |     0 | 0:01'50'' |
| Q25L150_200000   |   60.4M |  13.0 |     150 |  105 |  55.83M |   7.560% | 4.64M | 3.95M |     0.85 |  4.54M |     0 | 0:00'35'' |
| Q25L150_400000   |  120.8M |  26.0 |     150 |  105 | 112.21M |   7.113% | 4.64M | 4.32M |     0.93 |  4.71M |     0 | 0:01'02'' |
| Q25L150_600000   |  181.2M |  39.0 |     150 |  105 | 168.43M |   7.050% | 4.64M | 4.42M |     0.95 |  4.72M |     0 | 0:01'10'' |
| Q25L150_800000   |  241.6M |  52.1 |     150 |  105 |  224.7M |   6.997% | 4.64M | 4.46M |     0.96 |  4.72M |     0 | 0:01'34'' |
| Q25L150_1000000  |    302M |  65.1 |     150 |  105 | 280.84M |   7.006% | 4.64M | 4.48M |     0.97 |  4.71M |     0 | 0:01'49'' |
| Q25L150_1200000  |  362.4M |  78.1 |     150 |  105 | 336.98M |   7.013% | 4.64M |  4.5M |     0.97 |  4.71M |     0 | 0:02'03'' |
| Q30L120_200000   |  55.65M |  12.0 |     139 |   91 |  53.79M |   3.341% | 4.64M | 4.09M |     0.88 |  4.59M |     0 | 0:00'31'' |
| Q30L120_400000   | 111.29M |  24.0 |     138 |   91 | 108.18M |   2.795% | 4.64M |  4.4M |     0.95 |  4.74M |     0 | 0:00'48'' |
| Q30L120_600000   | 166.95M |  36.0 |     138 |   91 | 162.43M |   2.706% | 4.64M | 4.47M |     0.96 |  4.72M |     0 | 0:01'22'' |
| Q30L120_800000   | 222.57M |  48.0 |     138 |   91 | 216.57M |   2.697% | 4.64M |  4.5M |     0.97 |  4.71M |     0 | 0:01'22'' |
| Q30L120_1000000  | 278.21M |  59.9 |     138 |   91 | 270.73M |   2.686% | 4.64M | 4.51M |     0.97 |  4.71M |     0 | 0:01'52'' |
| Q30L120_1200000  | 333.85M |  71.9 |     138 |   91 | 324.89M |   2.686% | 4.64M | 4.52M |     0.97 |   4.7M |     0 | 0:02'11'' |
| Q30L130_200000   |  57.74M |  12.4 |     144 |   95 |  55.39M |   4.061% | 4.64M | 3.75M |     0.81 |  4.22M |     0 | 0:00'34'' |
| Q30L130_400000   | 115.47M |  24.9 |     144 |   95 | 111.91M |   3.087% | 4.64M |  4.2M |     0.90 |  4.57M |     0 | 0:00'48'' |
| Q30L130_600000   | 173.22M |  37.3 |     144 |   95 | 168.07M |   2.970% | 4.64M | 4.34M |     0.93 |  4.65M |     0 | 0:00'58'' |
| Q30L140_200000   |  59.93M |  12.9 |     149 |  105 |  56.92M |   5.034% | 4.64M | 3.11M |     0.67 |   3.6M |     0 | 0:00'34'' |
| Q30L150_200000   |   60.4M |  13.0 |     150 |  105 |  57.15M |   5.387% | 4.64M | 2.87M |     0.62 |  3.29M |     0 | 0:00'26'' |

* Illumina reads 的分布是有偏性的. 极端 GC 区域, 结构复杂区域都会得到较低的 fq 分值, 本应被 trim 掉.
  但覆盖度过高时, 这些区域之间的 reads 相互支持, 被保留下来的概率大大增加.
    * Discard% 在 CovFq 大于 100 倍时, 快速下降.
* Illumina reads 错误率约为 1% 不到一点. 当覆盖度过高时, 错误的点重复出现的概率要比完全无偏性的情况大一些.
    * 理论上 Subs% 应该是恒定值, 但当 CovFq 大于 100 倍时, 这个值在下降, 也就是这些错误的点相互支持, 躲过了 Kmer
      纠错.
* 直接的反映就是 EstG 过大, SumSR 过大.
* 留下的错误片段, 会形成 **伪独立** 片段, 降低 N50 SR
* 留下的错误位点, 会形成 **伪杂合** 位点, 降低 N50 SR
* trimmed 的 N50 比 filter 要大一些, 可能是留下了更多二代测序效果较差的位置. 同样 2400000 对 reads, trim 的 EstG
  更接近真实值
    * Real - 4.64M
    * Trimmed - 4.61M (EstG)
    * Filter - 4.59M (EstG)
* 但是 trimmed 里出 misassemblies 的概率要比 filter 大.

| Name             | N50SRclean |   Sum |    # | N50Anchor |     Sum |    # | N50Anchor2 |     Sum |   # | N50Others |     Sum |    # |   RunTime |
|:-----------------|-----------:|------:|-----:|----------:|--------:|-----:|-----------:|--------:|----:|----------:|--------:|-----:|----------:|
| original_200000  |       1441 | 3.86M | 3060 |      2008 |   2.44M | 1270 |       1338 | 249.48K | 183 |       756 |   1.17M | 1607 | 0:01'01'' |
| original_400000  |       3344 | 4.49M | 1919 |      3735 |      4M | 1319 |       1390 |  81.69K |  59 |       787 | 405.76K |  541 | 0:01'31'' |
| original_600000  |       2643 |  4.5M | 2228 |      3024 |   3.91M | 1478 |       1313 |  69.92K |  52 |       788 | 523.61K |  698 | 0:01'49'' |
| original_800000  |       2021 | 4.45M | 2745 |      2352 |   3.63M | 1653 |       1275 |   26.5K |  21 |       773 | 790.68K | 1071 | 0:01'43'' |
| original_1000000 |       1648 | 4.31M | 3132 |      2022 |   3.24M | 1676 |       1210 |  25.49K |  21 |       765 |   1.05M | 1435 | 0:01'38'' |
| original_1200000 |       1398 | 4.15M | 3387 |      1832 |   2.85M | 1589 |       1288 |  10.84K |   8 |       751 |   1.29M | 1790 | 0:02'28'' |
| original_1400000 |       1253 | 3.95M | 3496 |      1715 |   2.49M | 1470 |       1144 |   3.63K |   3 |       748 |   1.46M | 2023 | 0:02'15'' |
| original_1600000 |       1145 | 3.77M | 3572 |      1590 |   2.18M | 1334 |       1447 |   2.79K |   2 |       733 |   1.59M | 2236 | 0:02'15'' |
| original_1800000 |       1045 | 3.56M | 3605 |      1506 |   1.87M | 1208 |          0 |       0 |   0 |       724 |   1.69M | 2397 | 0:02'44'' |
| original_2000000 |        974 | 3.36M | 3573 |      1489 |   1.58M | 1040 |          0 |       0 |   0 |       723 |   1.78M | 2533 | 0:02'08'' |
| original_2200000 |        931 | 3.15M | 3496 |         0 |       0 |    0 |          0 |       0 |   0 |       931 |   3.15M | 3496 | 0:02'22'' |
| original_2400000 |        880 | 2.92M | 3340 |      1449 |   1.15M |  772 |          0 |       0 |   0 |       699 |   1.76M | 2568 | 0:02'35'' |
| original_2600000 |        838 | 2.72M | 3239 |      1416 | 983.45K |  683 |          0 |       0 |   0 |       687 |   1.74M | 2556 | 0:02'31'' |
| original_2800000 |        808 | 2.51M | 3077 |      1341 | 847.21K |  603 |          0 |       0 |   0 |       681 |   1.67M | 2474 | 0:02'50'' |
| original_3000000 |        809 | 2.25M | 2770 |      1335 | 727.48K |  520 |       2850 |   2.85K |   1 |       679 |   1.52M | 2249 | 0:02'33'' |
| original_3200000 |        778 | 2.07M | 2636 |      1341 | 612.95K |  440 |       1934 |   1.93K |   1 |       664 |   1.46M | 2195 | 0:02'20'' |
| original_3400000 |        752 | 1.87M | 2420 |      1366 | 490.16K |  347 |          0 |       0 |   0 |       665 |   1.38M | 2073 | 0:02'17'' |
| original_3600000 |        732 | 1.71M | 2275 |         0 |       0 |    0 |          0 |       0 |   0 |       732 |   1.71M | 2275 | 0:02'37'' |
| original_3800000 |        717 | 1.52M | 2049 |      1237 | 340.74K |  260 |          0 |       0 |   0 |       657 |   1.18M | 1789 | 0:02'32'' |
| original_4000000 |        707 | 1.35M | 1839 |         0 |       0 |    0 |          0 |       0 |   0 |       707 |   1.35M | 1839 | 0:02'50'' |
| Q20L120_200000   |        866 |  2.6M | 3038 |      1407 | 938.35K |  644 |       1151 |  11.79K |  10 |       703 |   1.65M | 2384 | 0:01'03'' |
| Q20L120_400000   |       2296 | 4.29M | 2452 |      2683 |   3.59M | 1503 |       2278 |   3.35K |   2 |       766 | 694.58K |  947 | 0:01'36'' |
| Q20L120_600000   |       4330 |  4.5M | 1552 |      4570 |   4.23M | 1180 |          0 |       0 |   0 |       783 | 276.19K |  372 | 0:01'21'' |
| Q20L120_800000   |       6811 | 4.54M | 1055 |      7021 |   4.41M |  876 |       1558 |   1.56K |   1 |       783 | 133.41K |  178 | 0:02'05'' |
| Q20L120_1000000  |       7929 | 4.56M |  926 |      8247 |   4.46M |  787 |          0 |       0 |   0 |       760 | 102.51K |  139 | 0:01'31'' |
| Q20L120_1200000  |       9132 | 4.57M |  842 |      9323 |   4.48M |  727 |          0 |       0 |   0 |       792 |  85.83K |  115 | 0:02'32'' |
| Q20L120_1400000  |       8446 | 4.57M |  842 |      8555 |    4.5M |  742 |          0 |       0 |   0 |       761 |  72.69K |  100 | 0:03'08'' |
| Q20L120_1600000  |       9129 | 4.58M |  818 |      9319 |    4.5M |  714 |          0 |       0 |   0 |       783 |  75.56K |  104 | 0:03'24'' |
| Q20L120_1800000  |       8207 | 4.58M |  880 |      8383 |   4.49M |  762 |       2185 |   2.19K |   1 |       783 |  85.55K |  117 | 0:03'32'' |
| Q20L120_2000000  |       7387 | 4.59M |  951 |      7495 |   4.51M |  844 |       2222 |   2.22K |   1 |       770 |  77.56K |  106 | 0:04'01'' |
| Q20L120_2200000  |       6656 |  4.6M | 1070 |      6728 |   4.49M |  922 |          0 |       0 |   0 |       765 | 108.32K |  148 | 0:03'57'' |
| Q20L120_2400000  |       5776 |  4.6M | 1175 |      5895 |   4.47M |  994 |          0 |       0 |   0 |       784 | 133.09K |  181 | 0:04'05'' |
| Q20L120_2600000  |       5160 | 4.61M | 1328 |      5319 |   4.44M | 1097 |       1903 |    1.9K |   1 |       791 | 172.34K |  230 | 0:04'06'' |
| Q20L120_2800000  |       4845 | 4.61M | 1436 |      5110 |    4.4M | 1154 |       2335 |   2.34K |   1 |       791 | 209.92K |  281 | 0:03'24'' |
| Q20L120_3000000  |       4264 | 4.62M | 1595 |      4589 |   4.38M | 1267 |          0 |       0 |   0 |       795 | 243.95K |  328 | 0:03'42'' |
| Q20L120_3200000  |       3914 | 4.62M | 1725 |      4116 |   4.33M | 1340 |       1981 |   6.11K |   3 |       805 | 288.09K |  382 | 0:04'11'' |
| Q20L120_3400000  |       3336 | 4.62M | 1893 |      3605 |   4.29M | 1451 |          0 |       0 |   0 |       785 | 328.92K |  442 | 0:03'58'' |
| Q20L120_3600000  |       2948 | 4.62M | 2099 |      3201 |   4.22M | 1567 |          0 |       0 |   0 |       793 | 397.05K |  532 | 0:03'56'' |
| Q20L120_3800000  |       2664 | 4.61M | 2271 |      2948 |   4.15M | 1642 |       1581 |   1.58K |   1 |       784 | 464.55K |  628 | 0:05'25'' |
| Q20L130_200000   |        934 | 2.73M | 3008 |         0 |       0 |    0 |          0 |       0 |   0 |       934 |   2.73M | 3008 | 0:01'03'' |
| Q20L130_400000   |       2432 | 4.26M | 2362 |      2813 |    3.6M | 1452 |       1251 |   7.82K |   6 |       743 | 649.02K |  904 | 0:01'34'' |
| Q20L130_600000   |       4215 | 4.46M | 1606 |      4497 |   4.16M | 1194 |       2732 |   5.28K |   2 |       761 | 301.55K |  410 | 0:01'50'' |
| Q20L130_800000   |       6183 | 4.52M | 1222 |      6387 |   4.34M |  978 |       1129 |   1.13K |   1 |       780 | 179.74K |  243 | 0:01'38'' |
| Q20L130_1000000  |       6981 | 4.54M | 1040 |      7183 |   4.41M |  859 |          0 |       0 |   0 |       783 | 135.31K |  181 | 0:01'52'' |
| Q20L130_1200000  |       7717 | 4.55M |  950 |      7818 |   4.45M |  810 |          0 |       0 |   0 |       787 | 104.44K |  140 | 0:02'55'' |
| Q20L130_1400000  |       8194 | 4.56M |  924 |      8286 |   4.47M |  801 |          0 |       0 |   0 |       777 |  90.36K |  123 | 0:03'17'' |
| Q20L130_1600000  |       7928 | 4.57M |  923 |      8107 |   4.48M |  802 |       1284 |   1.28K |   1 |       761 |  86.28K |  120 | 0:03'48'' |
| Q20L130_1800000  |       7268 | 4.57M |  980 |      7419 |   4.47M |  834 |          0 |       0 |   0 |       753 | 106.02K |  146 | 0:03'25'' |
| Q20L130_2000000  |       6813 | 4.58M | 1038 |      7024 |   4.46M |  884 |          0 |       0 |   0 |       786 | 114.21K |  154 | 0:03'09'' |
| Q20L130_2200000  |       6300 | 4.59M | 1135 |      6493 |   4.45M |  947 |          0 |       0 |   0 |       771 | 137.12K |  188 | 0:03'12'' |
| Q20L130_2400000  |       5610 | 4.59M | 1216 |      5749 |   4.45M | 1028 |          0 |       0 |   0 |       797 | 141.48K |  188 | 0:03'22'' |
| Q20L130_2600000  |       4985 |  4.6M | 1336 |      5208 |   4.43M | 1106 |       2786 |   2.79K |   1 |       785 | 170.02K |  229 | 0:03'07'' |
| Q20L130_2800000  |       4578 | 4.61M | 1467 |      4740 |    4.4M | 1187 |          0 |       0 |   0 |       783 | 207.14K |  280 | 0:03'40'' |
| Q20L130_3000000  |       4201 | 4.61M | 1605 |      4423 |   4.37M | 1279 |          0 |       0 |   0 |       780 | 242.35K |  326 | 0:04'03'' |
| Q20L130_3200000  |       3813 | 4.62M | 1744 |      3970 |   4.33M | 1357 |       2234 |   2.23K |   1 |       772 | 284.01K |  386 | 0:04'09'' |
| Q20L140_200000   |        981 | 2.78M | 2915 |      1580 |   1.29M |  803 |       1172 |  24.82K |  20 |       708 |   1.46M | 2092 | 0:00'38'' |
| Q20L140_400000   |       2175 | 4.13M | 2462 |      2674 |   3.38M | 1433 |       1337 |   6.25K |   5 |       761 | 747.64K | 1024 | 0:00'54'' |
| Q20L140_600000   |       3598 |  4.4M | 1815 |      3979 |   4.01M | 1289 |       1127 |   1.13K |   1 |       766 | 384.35K |  525 | 0:01'05'' |
| Q20L140_800000   |       4917 | 4.47M | 1459 |      5200 |   4.21M | 1109 |          0 |       0 |   0 |       781 |  261.1K |  350 | 0:01'23'' |
| Q20L140_1000000  |       5526 |  4.5M | 1263 |      5815 |   4.31M | 1005 |          0 |       0 |   0 |       801 | 194.54K |  258 | 0:02'03'' |
| Q20L140_1200000  |       6364 | 4.52M | 1169 |      6628 |   4.35M |  946 |       2764 |   2.76K |   1 |       804 | 165.65K |  222 | 0:02'42'' |
| Q20L140_1400000  |       6605 | 4.53M | 1122 |      6782 |   4.39M |  923 |       2369 |   2.37K |   1 |       783 | 146.18K |  198 | 0:02'41'' |
| Q20L140_1600000  |       6294 | 4.54M | 1131 |      6579 |   4.39M |  932 |       3209 |    5.7K |   2 |       782 | 145.32K |  197 | 0:02'22'' |
| Q20L140_1800000  |       6247 | 4.56M | 1142 |      6456 |   4.41M |  951 |       2770 |   2.77K |   1 |       783 | 140.85K |  190 | 0:02'59'' |
| Q20L140_2000000  |       5961 | 4.56M | 1183 |      6214 |   4.41M |  973 |          0 |       0 |   0 |       775 | 154.91K |  210 | 0:03'10'' |
| Q20L140_2200000  |       5474 | 4.57M | 1267 |      5577 |   4.41M | 1052 |          0 |       0 |   0 |       760 | 157.93K |  215 | 0:03'17'' |
| Q20L140_2400000  |       5000 | 4.58M | 1359 |      5153 |    4.4M | 1114 |          0 |       0 |   0 |       760 | 179.19K |  245 | 0:03'28'' |
| Q20L140_2600000  |       4732 | 4.59M | 1457 |      4840 |   4.38M | 1172 |          0 |       0 |   0 |       760 | 208.84K |  285 | 0:03'36'' |
| Q20L150_200000   |       1022 | 2.73M | 2811 |      1592 |   1.32M |  814 |       1146 |  23.14K |  18 |       714 |   1.39M | 1979 | 0:00'58'' |
| Q20L150_400000   |       2160 | 4.11M | 2476 |      2606 |   3.33M | 1413 |       1259 |  14.04K |  11 |       762 | 764.81K | 1052 | 0:01'17'' |
| Q20L150_600000   |       3342 | 4.37M | 1887 |      3892 |   3.93M | 1289 |       2196 |   3.37K |   2 |       775 | 440.69K |  596 | 0:01'33'' |
| Q20L150_800000   |       4400 | 4.46M | 1562 |      4618 |   4.17M | 1176 |       1212 |   6.73K |   5 |       786 | 283.17K |  381 | 0:01'32'' |
| Q20L150_1000000  |       5385 | 4.49M | 1342 |      5719 |   4.26M | 1024 |       2093 |   2.09K |   1 |       793 | 236.46K |  317 | 0:01'50'' |
| Q20L150_1200000  |       5966 | 4.51M | 1197 |      6214 |   4.34M |  970 |          0 |       0 |   0 |       783 | 168.99K |  227 | 0:02'17'' |
| Q20L150_1400000  |       6109 | 4.52M | 1175 |      6352 |   4.35M |  941 |       1601 |    1.6K |   1 |       773 | 171.14K |  233 | 0:02'26'' |
| Q20L150_1600000  |       6285 | 4.54M | 1156 |      6574 |   4.37M |  930 |          0 |       0 |   0 |       771 | 165.93K |  226 | 0:02'21'' |
| Q20L150_1800000  |       6241 | 4.55M | 1164 |      6428 |   4.39M |  950 |          0 |       0 |   0 |       787 | 158.72K |  214 | 0:02'50'' |
| Q20L150_2000000  |       5885 | 4.56M | 1210 |      6134 |   4.39M |  988 |          0 |       0 |   0 |       783 |  165.2K |  222 | 0:03'20'' |
| Q20L150_2200000  |       5503 | 4.57M | 1274 |      5780 |   4.38M | 1028 |       3349 |   6.46K |   2 |       767 | 178.53K |  244 | 0:03'32'' |
| Q20L150_2400000  |       5025 | 4.58M | 1369 |      5249 |   4.38M | 1095 |          0 |       0 |   0 |       777 | 202.76K |  274 | 0:03'45'' |
| Q25L120_200000   |       1141 | 3.25M | 3051 |      1707 |   1.83M | 1068 |       1257 |  22.13K |  16 |       735 |    1.4M | 1967 | 0:01'09'' |
| Q25L120_400000   |       2889 | 4.31M | 2089 |      3252 |    3.8M | 1391 |       1240 |   5.13K |   4 |       763 | 506.57K |  694 | 0:01'37'' |
| Q25L120_600000   |       4686 | 4.47M | 1474 |      5122 |   4.21M | 1129 |          0 |       0 |   0 |       774 | 254.34K |  345 | 0:01'47'' |
| Q25L120_800000   |       6234 | 4.52M | 1156 |      6596 |   4.35M |  933 |       2876 |   4.02K |   2 |       796 | 165.89K |  221 | 0:02'02'' |
| Q25L120_1000000  |       7910 | 4.53M |  969 |      8233 |   4.42M |  817 |       2668 |   2.67K |   1 |       769 | 111.12K |  151 | 0:02'23'' |
| Q25L120_1200000  |       8495 | 4.54M |  893 |      8696 |   4.44M |  767 |          0 |       0 |   0 |       756 |  91.73K |  126 | 0:02'40'' |
| Q25L120_1400000  |       9687 | 4.55M |  818 |      9851 |   4.46M |  699 |          0 |       0 |   0 |       755 |  85.89K |  119 | 0:02'54'' |
| Q25L120_1600000  |       9808 | 4.55M |  790 |      9997 |   4.47M |  686 |          0 |       0 |   0 |       759 |  76.03K |  104 | 0:03'15'' |
| Q25L120_1800000  |      10302 | 4.55M |  747 |     10352 |   4.48M |  651 |          0 |       0 |   0 |       786 |  71.46K |   96 | 0:03'30'' |
| Q25L120_2000000  |      10729 | 4.55M |  728 |     10858 |   4.48M |  634 |          0 |       0 |   0 |       758 |  69.34K |   94 | 0:03'23'' |
| Q25L120_2200000  |      10897 | 4.55M |  711 |     11198 |   4.49M |  624 |          0 |       0 |   0 |       790 |  65.45K |   87 | 0:03'36'' |
| Q25L120_2400000  |      11738 | 4.56M |  685 |     11817 |    4.5M |  604 |          0 |       0 |   0 |       760 |  59.25K |   81 | 0:03'43'' |
| Q25L120_2600000  |      10964 | 4.56M |  697 |     11164 |    4.5M |  610 |          0 |       0 |   0 |       759 |  62.91K |   87 | 0:03'49'' |
| Q25L120_2800000  |      11082 | 4.56M |  673 |     11128 |   4.51M |  598 |          0 |       0 |   0 |       760 |  54.86K |   75 | 0:03'55'' |
| Q25L130_200000   |        967 | 2.58M | 2751 |      1560 |   1.19M |  749 |       1234 |  13.37K |  10 |       700 |   1.37M | 1992 | 0:01'00'' |
| Q25L130_400000   |       2096 |  4.1M | 2503 |      2604 |   3.29M | 1407 |       1339 |   7.18K |   5 |       768 | 799.88K | 1091 | 0:01'29'' |
| Q25L130_600000   |       3250 | 4.35M | 1915 |      3757 |   3.87M | 1284 |       2222 |  15.13K |   7 |       781 | 462.43K |  624 | 0:01'34'' |
| Q25L130_800000   |       4249 | 4.45M | 1604 |      4658 |   4.14M | 1182 |          0 |       0 |   0 |       767 | 309.01K |  422 | 0:01'54'' |
| Q25L130_1000000  |       4883 | 4.48M | 1415 |      5288 |   4.24M | 1092 |       1303 |   2.44K |   2 |       795 | 238.77K |  321 | 0:02'09'' |
| Q25L130_1200000  |       5494 |  4.5M | 1282 |      5869 |    4.3M | 1005 |       1086 |   1.09K |   1 |       769 | 201.98K |  276 | 0:02'30'' |
| Q25L130_1400000  |       6223 | 4.52M | 1192 |      6456 |   4.34M |  953 |       3970 |   3.97K |   1 |       782 | 175.72K |  238 | 0:02'40'' |
| Q25L130_1600000  |       7075 | 4.53M | 1095 |      7301 |   4.39M |  897 |          0 |       0 |   0 |       760 | 143.67K |  198 | 0:02'53'' |
| Q25L130_1800000  |       7228 | 4.54M | 1058 |      7438 |    4.4M |  868 |       2234 |   5.75K |   3 |       746 | 135.29K |  187 | 0:03'12'' |
| Q25L130_2000000  |       7690 | 4.54M | 1021 |      7988 |    4.4M |  829 |       2327 |   2.33K |   1 |       754 | 136.91K |  191 | 0:03'29'' |
| Q25L140_200000   |       1040 | 2.49M | 2498 |      1674 |   1.25M |  739 |       1219 |  11.71K |  10 |       714 |   1.22M | 1749 | 0:01'02'' |
| Q25L140_400000   |       1691 | 3.72M | 2687 |      2227 |   2.73M | 1297 |       1098 |   8.22K |   7 |       736 | 984.86K | 1383 | 0:01'25'' |
| Q25L140_600000   |       2336 | 4.11M | 2311 |      2759 |   3.44M | 1391 |       1481 |   7.41K |   5 |       749 | 661.13K |  915 | 0:01'41'' |
| Q25L140_800000   |       2773 | 4.27M | 2096 |      3371 |   3.72M | 1340 |       1289 |  11.01K |   7 |       758 | 543.28K |  749 | 0:01'53'' |
| Q25L140_1000000  |       3516 | 4.36M | 1883 |      3967 |   3.91M | 1273 |       1238 |   1.24K |   1 |       767 | 445.11K |  609 | 0:02'02'' |
| Q25L140_1200000  |       3771 |  4.4M | 1742 |      4237 |   4.02M | 1226 |       2083 |    3.2K |   2 |       770 | 376.46K |  514 | 0:02'23'' |
| Q25L150_200000   |       1020 | 2.43M | 2474 |      1683 |    1.2M |  707 |       1176 |   14.2K |  12 |       704 |   1.22M | 1755 | 0:00'59'' |
| Q25L150_400000   |       1647 | 3.66M | 2708 |      2220 |   2.61M | 1255 |       1234 |  18.31K |  14 |       740 |   1.03M | 1439 | 0:01'23'' |
| Q25L150_600000   |       2178 | 4.05M | 2416 |      2633 |    3.3M | 1374 |       1172 |  11.36K |   8 |       751 | 744.36K | 1034 | 0:01'37'' |
| Q25L150_800000   |       2686 | 4.22M | 2157 |      3183 |   3.62M | 1345 |       1550 |  14.67K |   9 |       764 | 583.29K |  803 | 0:01'53'' |
| Q25L150_1000000  |       3066 | 4.31M | 1975 |      3542 |   3.82M | 1316 |       2281 |   2.28K |   1 |       770 | 483.33K |  658 | 0:02'05'' |
| Q25L150_1200000  |       3517 | 4.37M | 1829 |      3914 |   3.96M | 1270 |       1146 |   1.15K |   1 |       758 | 406.01K |  558 | 0:02'19'' |
| Q30L120_200000   |       1079 |  2.6M | 2548 |         0 |       0 |    0 |          0 |       0 |   0 |      1079 |    2.6M | 2548 | 0:01'01'' |
| Q30L120_400000   |       1756 | 3.78M | 2631 |      2241 |   2.87M | 1354 |       1229 |   4.96K |   4 |       735 | 908.59K | 1273 | 0:01'26'' |
| Q30L120_600000   |       2474 | 4.15M | 2260 |         0 |       0 |    0 |          0 |       0 |   0 |      2474 |   4.15M | 2260 | 0:01'38'' |
| Q30L120_800000   |       3052 | 4.29M | 1996 |      3393 |   3.82M | 1357 |       2603 |  10.33K |   5 |       759 | 461.73K |  634 | 0:01'56'' |
| Q30L120_1000000  |       3497 | 4.36M | 1819 |      3840 |   3.97M | 1291 |       1987 |   1.99K |   1 |       758 | 385.13K |  527 | 0:02'13'' |
| Q30L120_1200000  |       4022 | 4.41M | 1657 |      4350 |   4.09M | 1219 |          0 |       0 |   0 |       763 |  321.7K |  438 | 0:02'31'' |
| Q30L130_200000   |       1030 | 2.28M | 2297 |      1765 |   1.13M |  645 |       1134 |  12.83K |  10 |       708 |   1.14M | 1642 | 0:01'00'' |
| Q30L130_400000   |       1494 | 3.37M | 2634 |      2032 |   2.33M | 1178 |       1338 |  13.87K |   9 |       732 |   1.03M | 1447 | 0:01'23'' |
| Q30L130_600000   |       1891 | 3.79M | 2512 |      2421 |   2.94M | 1323 |       1261 |  11.36K |   9 |       754 | 848.01K | 1180 | 0:01'40'' |
| Q30L140_200000   |        962 | 1.61M | 1695 |      1735 | 749.22K |  431 |       1217 |    6.7K |   5 |       689 | 857.93K | 1259 | 0:01'01'' |
| Q30L150_200000   |        933 | 1.51M | 1613 |      1774 | 666.56K |  378 |       2700 |   5.06K |   3 |       685 | 838.23K | 1232 | 0:00'59'' |


| Name             | N50SRclean |   Sum |    # | N50Anchor |     Sum |    # | N50Anchor2 |     Sum |   # | N50Others |     Sum |    # |   RunTime |
|:-----------------|-----------:|------:|-----:|----------:|--------:|-----:|-----------:|--------:|----:|----------:|--------:|-----:|----------:|
| original_600000  |       2643 |  4.5M | 2228 |      3024 |   3.91M | 1478 |       1313 |  69.92K |  52 |       788 | 523.61K |  698 | 0:01'49'' |
| Q20L120_1600000  |       9129 | 4.58M |  818 |      9319 |    4.5M |  714 |          0 |       0 |   0 |       783 |  75.56K |  104 | 0:03'24'' |
| Q20L130_1600000  |       7928 | 4.57M |  923 |      8107 |   4.48M |  802 |       1284 |   1.28K |   1 |       761 |  86.28K |  120 | 0:03'48'' |
| Q20L140_1400000  |       6605 | 4.53M | 1122 |      6782 |   4.39M |  923 |       2369 |   2.37K |   1 |       783 | 146.18K |  198 | 0:02'41'' |
| Q20L150_1600000  |       6285 | 4.54M | 1156 |      6574 |   4.37M |  930 |          0 |       0 |   0 |       771 | 165.93K |  226 | 0:02'21'' |
| Q25L120_2800000  |      11082 | 4.56M |  673 |     11128 |   4.51M |  598 |          0 |       0 |   0 |       760 |  54.86K |   75 | 0:03'55'' |
| Q25L130_2000000  |       7690 | 4.54M | 1021 |      7988 |    4.4M |  829 |       2327 |   2.33K |   1 |       754 | 136.91K |  191 | 0:03'29'' |
| Q25L140_1200000  |       3771 |  4.4M | 1742 |      4237 |   4.02M | 1226 |       2083 |    3.2K |   2 |       770 | 376.46K |  514 | 0:02'23'' |
| Q25L150_1200000  |       3517 | 4.37M | 1829 |      3914 |   3.96M | 1270 |       1146 |   1.15K |   1 |       758 | 406.01K |  558 | 0:02'19'' |
| Q30L120_1200000  |       4022 | 4.41M | 1657 |      4350 |   4.09M | 1219 |          0 |       0 |   0 |       763 |  321.7K |  438 | 0:02'31'' |

## Quality assessment

http://www.opiniomics.org/generate-a-single-contig-hybrid-assembly-of-e-coli-using-miseq-and-minion-data/

```bash
BASE_DIR=$HOME/data/anchr/e_coli_tuning
cd ${BASE_DIR}

# sort on ref
for part in anchor anchor2 others;
do 
    bash ~/Scripts/cpan/App-Anchr/share/sort_on_ref.sh trimmed_800000/anchor/pe.${part}.fa 1_genome/genome.fa pe.${part}
    nucmer -l 200 1_genome/genome.fa pe.${part}.fa
    mummerplot -png out.delta -p pe.${part} --medium
done

cp ~/data/alignment/self/ecoli/Results/MG1655/MG1655.multi.fas 1_genome/paralogs.fas

nucmer -l 200 NC_000913.fa falcon.fa
mummerplot -png out.delta -p falcon --medium

# mummerplot files
rm *.[fr]plot
rm out.delta
rm *.gp

# merge anchors
mkdir merge
anchr contained \
    Q20L120_1600000/anchor/pe.anchor.fa \
    Q20L150_1600000/anchor/pe.anchor.fa \
    Q25L120_2800000/anchor/pe.anchor.fa \
    Q25L150_1200000/anchor/pe.anchor.fa \
    Q30L120_1200000/anchor/pe.anchor.fa \
    --len 1000 --idt 0.98 \
    -o stdout \
    | faops filter -a 1000 -l 0 stdin merge/anchor.contained.fasta
anchr orient merge/anchor.contained.fasta --len 1000 --idt 0.98 -o merge/anchor.orient.fasta
anchr merge merge/anchor.orient.fasta --len 1000 --idt 0.999 -o stdout \
    | faops filter -a 1000 -l 0 stdin merge/anchor.merge.fasta

# quast
rm -fr 9_qa
quast --no-check \
    -R 1_genome/genome.fa \
    Q20L120_1600000/anchor/pe.anchor.fa \
    Q20L150_1600000/anchor/pe.anchor.fa \
    Q25L120_2800000/anchor/pe.anchor.fa \
    Q25L150_1200000/anchor/pe.anchor.fa \
    Q30L120_1200000/anchor/pe.anchor.fa \
    merge/anchor.merge.fasta \
    1_genome/paralogs.fas \
    --label "Q20L120_1600000,Q20L150_1600000,Q25L120_2800000,Q25L150_1200000,Q30L120_1200000,merge,paralogs" \
    -o 9_qa
```
