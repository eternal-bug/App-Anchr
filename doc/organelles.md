# Assemble organelles by ANCHR

[TOC levels=1-3]: # " "
- [Assemble organelles by ANCHR](#assemble-organelles-by-anchr)
- [S288c organelle](#s288c-organelle)
    - [s288cO: download](#s288co-download)
    - [s288cO: template](#s288co-template)
    - [s288cO: run](#s288co-run)


# S288c organelle

* Genome: GCF_000146045.2, 12.1571 Mb
* Mitochondrion: NC_001224, 85779 bp

## s288cO: download

* Reference genome

```bash
mkdir -p ${HOME}/data/anchr/s288cO/1_genome
cd ${HOME}/data/anchr/s288cO/1_genome

for ACCESSION in "NC_001224"; do
    URL=$(printf "https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=nucleotide&rettype=%s&id=%s&retmode=text" "fasta" "${ACCESSION}");
    curl $URL -o ${ACCESSION}.fa
done

TAB=$'\t'
cat <<EOF > replace.tsv
NC_001224.1${TAB}Mt
EOF

cat NC_001224.fa |
    faops replace stdin replace.tsv stdout |
    faops order stdin <(echo Mt) genome.fa

```

* Illumina
    * ERR1938683
    * 995.5 Mb
    * ~81.9x

```bash
mkdir -p ${HOME}/data/anchr/s288cO/2_illumina
cd ${HOME}/data/anchr/s288cO/2_illumina

cp ${HOME}/data/anchr/s288c/2_illumina/ERR1938683_{1,2}.fastq.gz .

ln -fs ERR1938683_1.fastq.gz R1.fq.gz
ln -fs ERR1938683_2.fastq.gz R2.fq.gz

```

## s288cO: template

* Rsync to hpcc

```bash
rsync -avP \
    ~/data/anchr/s288cO/ \
    wangq@202.119.37.251:data/anchr/s288cO

# rsync -avP wangq@202.119.37.251:data/anchr/s288cO/ ~/data/anchr/s288cO

```


* template

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=s288cO

cd ${WORKING_DIR}/${BASE_NAME}

rm -f *.sh
anchr template \
    . \
    --basename ${BASE_NAME} \
    --queue mpi \
    --genome 1_000_000 \
    --fastqc \
    --kmergenie \
    --insertsize \
    --sgapreqc \
    --trim2 "--dedupe --cutoff 328 --cutk 31" \
    --qual2 "25" \
    --len2 "60" \
    --filter "adapter,phix,artifact" \
    --mergereads \
    --ecphase "1,2,3" \
    --cov2 "40 80 120 160 240 320" \
    --tadpole \
    --splitp 100 \
    --statp 2 \
    --fillanchor \
    --xmx 110g \
    --parallel 24

```

## s288cO: run

```bash
WORKING_DIR=${HOME}/data/anchr
BASE_NAME=s288cO

cd ${WORKING_DIR}/${BASE_NAME}
# rm -fr 4_*/ 6_*/ 7_*/ 8_*/ && rm -fr 2_illumina/trim 2_illumina/mergereads statReads.md 
# find . -type d -name "anchor" | xargs rm -fr

bash 0_bsub.sh
# bkill -J "${BASE_NAME}-*"

# bash 0_master.sh
# bash 0_cleanup.sh

```

Table: statInsertSize

| Group | Mean | Median | STDev | PercentOfPairs/PairOrientation |
|:--|--:|--:|--:|--:|
| R.genome.bbtools | 0.0 | 0 | 0.0 | 0.00% |
| R.tadpole.bbtools | 394.9 | 361 | 139.3 | 42.87% |
| R.tadpole.picard | 394.4 | 360 | 139.4 | FR |


Table: statReads

| Name | N50 | Sum | # |
|:--|--:|--:|--:|
| Genome | 85779 | 85779 | 1 |
| Illumina.R | 150 | 995.54M | 6636934 |
| trim.R | 150 | 177.18M | 1184286 |
| Q25L60 | 150 | 168.71M | 1142921 |


Table: statTrimReads

| Name | N50 | Sum | # |
|:--|--:|--:|--:|
| clumpify | 150 | 992.93M | 6619558 |
| highpass | 150 | 177.92M | 1186106 |
| trim | 150 | 177.18M | 1184286 |
| filter | 150 | 177.18M | 1184286 |
| R1 | 150 | 88.66M | 592143 |
| R2 | 150 | 88.52M | 592143 |
| Rs | 0 | 0 | 0 |


```text
#R.trim
#Matched	1612	0.13591%
#Name	Reads	ReadsPct
```

```text
#R.filter
#Matched	0	0.00000%
#Name	Reads	ReadsPct
```

```text
#R.peaks
#k	31
#unique_kmers	3672612
#main_peak	508
#genome_size	238322
#haploid_genome_size	238322
#fold_coverage	508
#haploid_fold_coverage	508
#ploidy	1
#percent_repeat	90.205
#start	center	stop	max	volume
```




Table: statMergeReads

| Name | N50 | Sum | # |
|:--|--:|--:|--:|
| clumped | 150 | 177.17M | 1184220 |
| ecco | 150 | 177.17M | 1184220 |
| eccc | 150 | 177.17M | 1184220 |
| ecct | 150 | 167.44M | 1117996 |
| extended | 190 | 210.03M | 1117996 |
| merged.raw | 380 | 145.84M | 394142 |
| unmerged.raw | 190 | 61.26M | 329712 |
| unmerged.trim | 190 | 61.26M | 329712 |
| M1 | 380 | 143.98M | 388929 |
| U1 | 190 | 30.72M | 164856 |
| U2 | 190 | 30.54M | 164856 |
| Us | 0 | 0 | 0 |
| M.cor | 337 | 205.63M | 1107570 |

| Group | Mean | Median | STDev | PercentOfPairs |
|:--|--:|--:|--:|--:|
| M.ihist.merge1.txt | 249.2 | 255 | 27.6 | 18.82% |
| M.ihist.merge.txt | 370.0 | 364 | 71.5 | 70.51% |



Table: statQuorum

| Name | CovIn | CovOut | Discard% | Kmer | RealG | EstG | Est/Real | RunTime |
|:--|--:|--:|--:|--:|--:|--:|--:|--:|
| Q0L0.R | 177.2 | 164.4 | 7.23% | "105" | 1M | 493.77K | 0.49 | 0:00'23'' |
| Q25L60.R | 168.7 | 161.0 | 4.60% | "105" | 1M | 329.78K | 0.33 | 0:00'22'' |


Table: statKunitigsAnchors.md

| Name | CovCor | Mapped% | N50Anchor | Sum | # | N50Others | Sum | # | median | MAD | lower | upper | Kmer | RunTimeKU | RunTimeAN |
|:--|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|
| Q0L0X40P000 | 40.0 | 10.97% | 2333 | 24.36K | 12 | 874 | 7.15K | 30 | 129.0 | 25.0 | 18.0 | 258.0 | "31,41,51,61,71,81" | 0:00'10'' | 0:00'20'' |
| Q0L0X40P001 | 40.0 | 9.13% | 2542 | 22.34K | 10 | 1118 | 6.49K | 24 | 124.0 | 26.0 | 15.3 | 248.0 | "31,41,51,61,71,81" | 0:00'09'' | 0:00'20'' |
| Q0L0X40P002 | 40.0 | 8.10% | 2561 | 21.83K | 8 | 1182 | 5.54K | 17 | 130.0 | 29.0 | 14.3 | 260.0 | "31,41,51,61,71,81" | 0:00'10'' | 0:00'18'' |
| Q0L0X80P000 | 80.0 | 7.76% | 2519 | 20.47K | 10 | 1311 | 5.88K | 23 | 253.0 | 56.0 | 28.3 | 506.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'18'' |
| Q0L0X80P001 | 80.0 | 7.44% | 2422 | 20.51K | 10 | 1165 | 4.18K | 20 | 278.0 | 59.0 | 33.7 | 556.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'19'' |
| Q0L0X120P000 | 120.0 | 6.49% | 2341 | 18.84K | 10 | 1182 | 4.34K | 20 | 391.0 | 86.0 | 44.3 | 782.0 | "31,41,51,61,71,81" | 0:00'25'' | 0:00'19'' |
| Q0L0X160P000 | 160.0 | 6.34% | 2333 | 18.18K | 10 | 1055 | 5.52K | 21 | 505.0 | 102.0 | 66.3 | 1010.0 | "31,41,51,61,71,81" | 0:00'32'' | 0:00'19'' |
| Q25L60X40P000 | 40.0 | 14.15% | 2688 | 27.64K | 12 | 1094 | 4.84K | 29 | 135.0 | 40.0 | 5.0 | 270.0 | "31,41,51,61,71,81" | 0:00'09'' | 0:00'19'' |
| Q25L60X40P001 | 40.0 | 11.71% | 3166 | 27.55K | 10 | 1083 | 2.64K | 21 | 141.0 | 44.0 | 3.0 | 282.0 | "31,41,51,61,71,81" | 0:00'09'' | 0:00'19'' |
| Q25L60X40P002 | 40.0 | 12.02% | 2729 | 27.72K | 12 | 1083 | 2.9K | 26 | 142.0 | 48.0 | 3.0 | 284.0 | "31,41,51,61,71,81" | 0:00'10'' | 0:00'18'' |
| Q25L60X80P000 | 80.0 | 8.81% | 2523 | 20.64K | 9 | 1190 | 4.92K | 19 | 286.0 | 70.0 | 25.3 | 572.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'18'' |
| Q25L60X80P001 | 80.0 | 7.64% | 2388 | 20.7K | 10 | 1154 | 5.49K | 21 | 268.0 | 67.0 | 22.3 | 536.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'18'' |
| Q25L60X120P000 | 120.0 | 7.35% | 2563 | 21.98K | 10 | 340 | 2.79K | 20 | 420.0 | 114.5 | 25.5 | 840.0 | "31,41,51,61,71,81" | 0:00'23'' | 0:00'19'' |
| Q25L60X160P000 | 160.0 | 7.36% | 2579 | 22.42K | 10 | 1055 | 3.51K | 21 | 542.0 | 153.0 | 27.7 | 1084.0 | "31,41,51,61,71,81" | 0:00'31'' | 0:00'20'' |


Table: statTadpoleAnchors.md

| Name | CovCor | Mapped% | N50Anchor | Sum | # | N50Others | Sum | # | median | MAD | lower | upper | Kmer | RunTimeKU | RunTimeAN |
|:--|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|
| Q0L0X40P000 | 40.0 | 54.72% | 2732 | 29.69K | 11 | 6255 | 11.37K | 24 | 150.0 | 52.5 | 3.0 | 300.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'20'' |
| Q0L0X40P001 | 40.0 | 55.15% | 3178 | 29.64K | 11 | 6325 | 11.41K | 26 | 148.0 | 52.0 | 3.0 | 296.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| Q0L0X40P002 | 40.0 | 54.91% | 2815 | 30.1K | 11 | 6254 | 11.61K | 24 | 150.0 | 58.5 | 3.0 | 300.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'19'' |
| Q0L0X80P000 | 80.0 | 55.56% | 3210 | 29.92K | 10 | 6325 | 11.48K | 23 | 290.0 | 94.5 | 3.0 | 580.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'20'' |
| Q0L0X80P001 | 80.0 | 54.86% | 3168 | 30.67K | 10 | 6254 | 11.46K | 21 | 303.0 | 115.0 | 3.0 | 606.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| Q0L0X120P000 | 120.0 | 54.74% | 3253 | 30.16K | 10 | 6255 | 11.48K | 19 | 451.0 | 167.0 | 3.0 | 902.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'19'' |
| Q0L0X160P000 | 160.0 | 54.93% | 3253 | 30.88K | 10 | 6255 | 11.43K | 21 | 594.0 | 217.0 | 3.0 | 1188.0 | "31,41,51,61,71,81" | 0:00'19'' | 0:00'21'' |
| Q25L60X40P000 | 40.0 | 55.91% | 2733 | 30.19K | 11 | 6255 | 11.37K | 25 | 151.0 | 53.5 | 3.0 | 302.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| Q25L60X40P001 | 40.0 | 55.94% | 3157 | 30.16K | 10 | 6255 | 11.4K | 24 | 150.0 | 52.0 | 3.0 | 300.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| Q25L60X40P002 | 40.0 | 55.68% | 3170 | 30.23K | 10 | 6254 | 11.44K | 22 | 154.0 | 56.0 | 3.0 | 308.0 | "31,41,51,61,71,81" | 0:00'16'' | 0:00'19'' |
| Q25L60X80P000 | 80.0 | 56.32% | 3192 | 30.67K | 10 | 6255 | 11.52K | 21 | 296.0 | 103.0 | 3.0 | 592.0 | "31,41,51,61,71,81" | 0:00'17'' | 0:00'20'' |
| Q25L60X80P001 | 80.0 | 57.86% | 3213 | 30.6K | 10 | 6254 | 11.56K | 25 | 300.0 | 105.5 | 3.0 | 600.0 | "31,41,51,61,71,81" | 0:00'15'' | 0:00'21'' |
| Q25L60X120P000 | 120.0 | 55.77% | 3242 | 30.98K | 10 | 6255 | 11.38K | 20 | 459.0 | 170.0 | 3.0 | 918.0 | "31,41,51,61,71,81" | 0:00'18'' | 0:00'21'' |
| Q25L60X160P000 | 160.0 | 55.81% | 3272 | 31K | 10 | 6255 | 11.37K | 19 | 613.0 | 229.0 | 3.0 | 1226.0 | "31,41,51,61,71,81" | 0:00'18'' | 0:00'20'' |


Table: statMRKunitigsAnchors.md

| Name | CovCor | Mapped% | N50Anchor | Sum | # | N50Others | Sum | # | median | MAD | lower | upper | Kmer | RunTimeKU | RunTimeAN |
|:--|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|
| MRX40P000 | 40.0 | 48.21% | 3204 | 29.03K | 10 | 2374 | 11.09K | 24 | 160.0 | 61.0 | 3.0 | 320.0 | "31,41,51,61,71,81" | 0:00'12'' | 0:00'20'' |
| MRX40P001 | 40.0 | 51.07% | 2951 | 29.92K | 11 | 2506 | 11.42K | 24 | 157.0 | 58.0 | 3.0 | 314.0 | "31,41,51,61,71,81" | 0:00'12'' | 0:00'20'' |
| MRX40P002 | 40.0 | 40.96% | 3131 | 29.7K | 11 | 2506 | 9.85K | 23 | 150.0 | 64.0 | 3.0 | 300.0 | "31,41,51,61,71,81" | 0:00'12'' | 0:00'19'' |
| MRX80P000 | 80.0 | 36.51% | 2987 | 28.86K | 11 | 2374 | 9.02K | 26 | 313.0 | 109.0 | 3.0 | 626.0 | "31,41,51,61,71,81" | 0:00'20'' | 0:00'20'' |
| MRX80P001 | 80.0 | 37.11% | 2792 | 28.46K | 12 | 2506 | 9.26K | 25 | 301.0 | 116.5 | 3.0 | 602.0 | "31,41,51,61,71,81" | 0:00'20'' | 0:00'20'' |
| MRX120P000 | 120.0 | 29.58% | 3159 | 26.42K | 10 | 2374 | 8.37K | 24 | 466.0 | 144.0 | 11.3 | 932.0 | "31,41,51,61,71,81" | 0:00'29'' | 0:00'20'' |
| MRX160P000 | 160.0 | 24.65% | 3259 | 27K | 11 | 2215 | 6.23K | 21 | 611.0 | 201.5 | 3.0 | 1222.0 | "31,41,51,61,71,81" | 0:00'39'' | 0:00'21'' |


Table: statMRTadpoleAnchors.md

| Name | CovCor | Mapped% | N50Anchor | Sum | # | N50Others | Sum | # | median | MAD | lower | upper | Kmer | RunTimeKU | RunTimeAN |
|:--|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|
| MRX40P000 | 40.0 | 53.88% | 3204 | 30.46K | 10 | 6325 | 11.41K | 22 | 160.0 | 61.0 | 3.0 | 320.0 | "31,41,51,61,71,81" | 0:05'09'' | 0:00'20'' |
| MRX40P001 | 40.0 | 58.95% | 3180 | 30.31K | 10 | 7108 | 12.3K | 21 | 158.0 | 59.0 | 3.0 | 316.0 | "31,41,51,61,71,81" | 0:00'28'' | 0:00'20'' |
| MRX40P002 | 40.0 | 59.21% | 2840 | 30.4K | 11 | 7108 | 12.15K | 23 | 153.0 | 57.5 | 3.0 | 306.0 | "31,41,51,61,71,81" | 0:00'27'' | 0:00'20'' |
| MRX80P000 | 80.0 | 59.15% | 3229 | 30.71K | 10 | 7108 | 12.08K | 22 | 318.0 | 114.0 | 3.0 | 636.0 | "31,41,51,61,71,81" | 0:00'45'' | 0:00'20'' |
| MRX80P001 | 80.0 | 59.82% | 3206 | 30.71K | 10 | 7108 | 12.19K | 23 | 290.0 | 97.0 | 3.0 | 580.0 | "31,41,51,61,71,81" | 0:00'56'' | 0:00'20'' |
| MRX120P000 | 120.0 | 59.22% | 3229 | 30.75K | 10 | 7108 | 11.98K | 22 | 472.0 | 162.0 | 3.0 | 944.0 | "31,41,51,61,71,81" | 0:00'46'' | 0:00'21'' |
| MRX160P000 | 160.0 | 59.29% | 3259 | 30.86K | 10 | 7108 | 11.96K | 22 | 624.0 | 214.5 | 3.0 | 1248.0 | "31,41,51,61,71,81" | 0:01'01'' | 0:00'20'' |


Table: statMergeAnchors.md

| Name | Mapped% | N50Anchor | Sum | # | N50Others | Sum | # | median | MAD | lower | upper | RunTimeAN |
|:--|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|
| 7_mergeAnchors | 0.00% | 3272 | 31.33K | 10 | 2506 | 18.2K | 8 | 0.0 | 0.0 | 0.0 | 0.0 |  |
| 7_mergeKunitigsAnchors | 0.00% | 3200 | 29.81K | 10 | 1187 | 15.34K | 13 | 0.0 | 0.0 | 0.0 | 0.0 |  |
| 7_mergeMRKunitigsAnchors | 0.00% | 3259 | 31.7K | 11 | 2465 | 13.45K | 6 | 0.0 | 0.0 | 0.0 | 0.0 |  |
| 7_mergeMRTadpoleAnchors | 0.00% | 3259 | 31.12K | 10 | 7108 | 11.83K | 3 | 0.0 | 0.0 | 0.0 | 0.0 |  |
| 7_mergeTadpoleAnchors | 0.00% | 3272 | 31.27K | 10 | 6325 | 11.05K | 3 | 0.0 | 0.0 | 0.0 | 0.0 |  |


Table: statOtherAnchors.md

| Name | Mapped% | N50Anchor | Sum | # | N50Others | Sum | # | median | MAD | lower | upper | RunTimeAN |
|:--|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|--:|
| 8_spades | 74.00% | 2886 | 41.52K | 15 | 2334 | 24.2K | 33 | 598.0 | 242.0 | 3.0 | 1196.0 | 0:00'20'' |
| 8_spades_MR | 73.55% | 2871 | 41.72K | 16 | 9067 | 15.81K | 31 | 771.0 | 312.5 | 3.0 | 1542.0 | 0:00'21'' |
| 8_megahit | 70.49% | 3275 | 33.29K | 11 | 2508 | 17.35K | 23 | 619.0 | 249.5 | 3.0 | 1238.0 | 0:00'21'' |
| 8_megahit_MR | 70.42% | 2556 | 48.03K | 22 | 8539 | 16.52K | 39 | 610.0 | 540.0 | 3.0 | 1220.0 | 0:00'22'' |
| 8_platanus | 54.54% | 5012 | 10K | 2 | 7616 | 7.98K | 3 | 1866.0 | 1029.0 | 3.0 | 3732.0 | 0:00'21'' |


Table: statFinal

| Name | N50 | Sum | # |
|:--|--:|--:|--:|
| Genome | 85779 | 85779 | 1 |
| 7_mergeAnchors.anchors | 3272 | 31332 | 10 |
| 7_mergeAnchors.others | 2506 | 18203 | 8 |
| anchorLong | 3272 | 31332 | 10 |
| anchorFill | 6603 | 31401 | 9 |
| spades.contig | 599 | 153944 | 553 |
| spades.scaffold | 599 | 153954 | 552 |
| spades.non-contained | 3013 | 65720 | 22 |
| spades_MR.contig | 283 | 193734 | 629 |
| spades_MR.scaffold | 283 | 193734 | 629 |
| spades_MR.non-contained | 3281 | 57526 | 20 |
| megahit.contig | 565 | 235364 | 438 |
| megahit.non-contained | 4664 | 50643 | 16 |
| megahit_MR.contig | 522 | 435061 | 921 |
| megahit_MR.non-contained | 2812 | 64555 | 27 |
| platanus.contig | 2451 | 33358 | 45 |
| platanus.scaffold | 5374 | 24452 | 35 |
| platanus.non-contained | 5374 | 17977 | 3 |
